/* CustomSignals GptMeasurement GptSignals HouseHold LegacyLayer SignalsAbs SignalsBsc SignalsIds SignalsTvp SignalsVlp */
(()=>{var In=Object.create;var bt=Object.defineProperty,Pn=Object.defineProperties,Cr=Object.getOwnPropertyDescriptor,On=Object.getOwnPropertyDescriptors,xn=Object.getOwnPropertyNames,_r=Object.getOwnPropertySymbols,Ln=Object.getPrototypeOf,wr=Object.prototype.hasOwnProperty,Nn=Object.prototype.propertyIsEnumerable;var tr=(n,e,t)=>e in n?bt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,q=(n,e)=>{for(var t in e||(e={}))wr.call(e,t)&&tr(n,t,e[t]);if(_r)for(var t of _r(e))Nn.call(e,t)&&tr(n,t,e[t]);return n},Xe=(n,e)=>Pn(n,On(e)),o=(n,e)=>bt(n,"name",{value:e,configurable:!0});var Dr=(n,e)=>()=>(n&&(e=n(n=0)),e);var Mn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Un=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of xn(e))!wr.call(n,i)&&i!==t&&bt(n,i,{get:()=>e[i],enumerable:!(r=Cr(e,i))||r.enumerable});return n};var Fn=(n,e,t)=>(t=n!=null?In(Ln(n)):{},Un(e||!n||!n.__esModule?bt(t,"default",{value:n,enumerable:!0}):t,n));var d=(n,e,t,r)=>{for(var i=r>1?void 0:r?Cr(e,t):e,l=n.length-1,u;l>=0;l--)(u=n[l])&&(i=(r?u(e,t,i):u(i))||i);return r&&i&&bt(e,t,i),i};var c=(n,e,t)=>tr(n,typeof e!="symbol"?e+"":e,t);var R=(n,e,t)=>new Promise((r,i)=>{var l=v=>{try{m(t.next(v))}catch(b){i(b)}},u=v=>{try{m(t.throw(v))}catch(b){i(b)}},m=v=>v.done?r(v.value):Promise.resolve(v.value).then(l,u);m((t=t.apply(n,e)).next())});var g,s=Dr(()=>{g=[{adServerId:"2200",adServerAccountId:"7175",type:"gpt",customTracking:{c1:{type:"targeting",key:"specialslot"},c3:{type:"targeting",key:"channel"},c4:{type:"targeting",key:"section"},c5:{type:"targeting",key:"author"},c6:{type:"targeting",key:"topics"}},adPositionKey:"pos"}]});var a=Dr(()=>{});var gn=Mn((pf,pn)=>{s();a();function Ei(n,e){if(typeof n!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof n}\`.`);let t,r=0;return o(function(...l){clearTimeout(t);let u=Date.now(),m=u-r,v=e-m;v<=0?(r=u,n.apply(this,l)):t=setTimeout(()=>{r=Date.now(),n.apply(this,l)},v)},"throttled")}o(Ei,"throttle");pn.exports=Ei});s();a();s();a();s();a();s();a();s();a();s();a();s();a();var B=[];for(let n=0;n<256;++n)B.push((n+256).toString(16).slice(1));function Ir(n,e=0){return(B[n[e+0]]+B[n[e+1]]+B[n[e+2]]+B[n[e+3]]+"-"+B[n[e+4]]+B[n[e+5]]+"-"+B[n[e+6]]+B[n[e+7]]+"-"+B[n[e+8]]+B[n[e+9]]+"-"+B[n[e+10]]+B[n[e+11]]+B[n[e+12]]+B[n[e+13]]+B[n[e+14]]+B[n[e+15]]).toLowerCase()}o(Ir,"unsafeStringify");s();a();var rr,qn=new Uint8Array(16);function nr(){if(!rr){if(typeof crypto=="undefined"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");rr=crypto.getRandomValues.bind(crypto)}return rr(qn)}o(nr,"rng");s();a();s();a();var $n=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),or={randomUUID:$n};function jn(n,e,t){var i,l,u;if(or.randomUUID&&!e&&!n)return or.randomUUID();n=n||{};let r=(u=(l=n.random)!=null?l:(i=n.rng)==null?void 0:i.call(n))!=null?u:nr();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let m=0;m<16;++m)e[t+m]=r[m];return e}return Ir(r)}o(jn,"v4");var ir=jn;var De=o(()=>ir(),"uuid");s();a();var dt=o((n,e)=>(...t)=>{try{let r=n(...t);return r instanceof Promise?r.then(i=>i,i=>e(i,...t)):r}catch(r){return e(r,...t)}},"withErrorHandler");s();a();var ut,ct,mt,Ae=class Ae{constructor(e,t){c(this,"collections",new Set);c(this,"children",new Ae.Set);c(this,"beforeDestroyed");this.beforeDestroyed=t!=null?t:()=>{};for(let[r,i]of Object.entries(e))Object.defineProperty(this,r,{value:i});e.parent!=null&&(e.parent.destroyed?this.destroy():e.parent.children.add(this))}static Create(e,t){return new Ae(e,t)}static CreateRoot(e,t){return new Ae(e,t)}destroy(){if(this.beforeDestroyed!=null){try{this.beforeDestroyed(this)}catch(e){}for(let e of this.children)e.destroy();this.beforeDestroyed=void 0;for(let e of this.collections)e.delete(this)}return this}get destroyed(){return this.beforeDestroyed==null}};o(Ae,"EntityClass"),c(Ae,"Set",(ut=class extends Set{add(t){return t.destroyed||(t.collections.add(this),super.add(t)),this}delete(t){return t.collections.delete(this),super.delete(t)}clear(){for(let t of this.values())t.collections.delete(this);super.clear()}peek(){return this.values().next().value}conjure(t){let r=this.peek();return r==null&&(r=t(),this.add(r)),r}},o(ut,"EntitySet"),ut)),c(Ae,"Map",(ct=class extends Map{set(t,r){return t.destroyed||(t.collections.add(this),super.set(t,r)),this}delete(t){return t.collections.delete(this),super.delete(t)}clear(){for(let t of this.keys())t.collections.delete(this);return super.clear()}summon(t,r){let i=super.get(t);return i==null&&(i=r,this.set(t,i)),i}conjure(t,r){let i=super.get(t);return i==null&&(i=r(),this.set(t,i)),i}},o(ct,"EntityMap"),ct)),c(Ae,"Link",(mt=class extends Ae.Map{get(t){return super.conjure(t,()=>new Ae.Set)}},o(mt,"EntityLink"),mt));var Je=Ae,E;(l=>(l.Set=Je.Set,l.Map=Je.Map,l.Link=Je.Link,l.Create=Je.Create,l.CreateRoot=Je.CreateRoot))(E||(E={}));s();a();var Ut=class Ut{constructor(e,t,r){c(this,"_message","unknown");c(this,"_trace",[]);c(this,"_silenced",!1);if(e instanceof Ut)return e.addToTrace(r,t);typeof e=="object"&&e!=null&&"message"in e&&typeof e.message=="string"?this._message=e.message:this._message=`${e}`,this.addToTrace(r,t)}get message(){return this._message}get trace(){return this._trace}get silenced(){return this._silenced}silence(){return this._silenced=!0,this}addToTrace(e,t){return this._trace.unshift(e),this.maybeCompleteTrace(t),this}maybeCompleteTrace(e){return R(this,null,function*(){let t=this._trace.length;yield Promise.resolve(),yield Promise.resolve(),yield Promise.resolve(),!this.silenced&&t===this._trace.length&&e(this)})}};o(Ut,"TracedError");var Rt=Ut;var sr=class sr{constructor(e){c(this,"moduleInstances",new Map);c(this,"methodsToExecute",[]);c(this,"errorHandlers",[]);c(this,"activeSession",null);c(this,"executedMethodIndex",0);this.initializeModules(e)}initializeModules(e){let t=e.map(r=>this.createModule(r));for(let r of t)this.applyModuleDecoration(r),this.applyExecuteDecoration(r),this.applyPluginDecoration(r),this.applyErrorDecoration(r),this.applyCatchErrorDecoration(r)}get session(){if(this.activeSession==null)throw new Error("Core has no active session");return this.activeSession}inject(e){let t=this.modules,r=[];for(let i of e){let l=t[i.name];l==null?r.push(i):this.moduleInstances.set(i,l)}this.initializeModules(r),console.log("Injected new modules:",r.map(i=>i.name)),this.execute()}get(e){return this.getModule(e)}execute(){this.activeSession==null&&(this.activeSession=E.CreateRoot({id:De()}));for(let e of this.methodsToExecute.slice(this.executedMethodIndex))e();this.executedMethodIndex=this.methodsToExecute.length}reset(){this.activeSession!=null&&(this.activeSession.destroy(),this.activeSession=null,this.executedMethodIndex=0)}get modules(){let e={};for(let[t,r]of this.moduleInstances)e[t.name]=r;return e}getModule(e){let t=this.moduleInstances.get(e);if(t==null)throw new Error(`module not in core: ${e.name}`);return t}createModule(e){if(e.prototype.moduleConfig==null)throw new Error(`not a module: ${e.name}`);let t=new e;return t.core=this,this.moduleInstances.set(e,t),t}applyModuleDecoration(e){var r;let t=e.constructor.prototype.moduleConfig;for(let{method:i}of t)e[i]=dt(e[i].bind(e),(l,...u)=>{throw this.traceError(l,`${e.constructor.name}.${i}(${u.map(m=>typeof m).join(",")})`)});(r=e.plugins)!=null||(e.plugins={}),e.pluginFunctions={};for(let i of Object.keys(e.plugins))e.pluginFunctions[i]=[],e.plugins[i]=(...l)=>{let u=[];for(let m of e.pluginFunctions[i])m(u,...l);return u}}applyExecuteDecoration(e){var r;let t=(r=e.constructor.prototype.executeConfig)!=null?r:[];for(let{method:i}of t)this.methodsToExecute.push(dt(e[i],l=>{this.traceError(l,"@execute")}))}applyPluginDecoration(e){var r;let t=(r=e.constructor.prototype.pluginConfig)!=null?r:[];for(let{PluggableClass:i,category:l,method:u}of t)this.getModule(i).pluginFunctions[l].push(dt((m,...v)=>{m.push(e[u](...v))},m=>{this.traceError(m,`@plugin(${i.name},'${l}')`)}))}applyErrorDecoration(e){var r;let t=(r=e.constructor.prototype.errorConfig)!=null?r:[];for(let{method:i}of t)this.errorHandlers.push(dt(e[i],l=>{l instanceof Rt&&l.silence()}))}applyCatchErrorDecoration(e){var r;let t=(r=e.constructor.prototype.catchErrorConfig)!=null?r:[];for(let{method:i}of t)e[i]=dt(e[i],l=>{this.traceError(l,"@catchError")})}traceError(e,t){return new Rt(e,r=>this.reportError(r),t)}reportError(e){for(let t of this.errorHandlers)t(e.message,[...e.trace])}};o(sr,"Core");var _t=sr;s();a();s();a();var ar=[],Ft=ar;var p=o(n=>{let e=n.prototype,t=Object.getOwnPropertyNames(e).filter(r=>{var i;return r!=="constructor"&&((i=Object.getOwnPropertyDescriptor(e,r))==null?void 0:i.value)instanceof Function});e.moduleConfig=t.map(r=>({method:r})),ar.push(n)},"moduleClass"),N=o(n=>e=>{},"attachModule"),M=o((n,e)=>{var t;n.executeConfig=(t=n.executeConfig)!=null?t:[],n.executeConfig.push({method:e})},"executeMethod"),S=o((n,e)=>(t,r)=>{var i;t.pluginConfig=(i=t.pluginConfig)!=null?i:[],t.pluginConfig.push({PluggableClass:n,category:e,method:r})},"pluginMethod"),de=o((n,e)=>{var t;n.catchErrorConfig=(t=n.catchErrorConfig)!=null?t:[],n.catchErrorConfig.push({method:e})},"catchErrorMethod"),lr=o((n,e)=>{var t;n.errorConfig=(t=n.errorConfig)!=null?t:[],n.errorConfig.push({method:e})},"errorMethod");s();a();s();a();s();a();var Bn=Object.defineProperty,Gn=Object.defineProperties,Vn=Object.getOwnPropertyDescriptors,Pr=Object.getOwnPropertySymbols,Qn=Object.prototype.hasOwnProperty,Hn=Object.prototype.propertyIsEnumerable,Or=o((n,e,t)=>e in n?Bn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,"__defNormalProp"),Ct=o((n,e)=>{for(var t in e||(e={}))Qn.call(e,t)&&Or(n,t,e[t]);if(Pr)for(var t of Pr(e))Hn.call(e,t)&&Or(n,t,e[t]);return n},"__spreadValues"),xr=o((n,e)=>Gn(n,Vn(e)),"__spreadProps");var pt=(n=>(n.GAM="gam",n.XANDR="xandr",n.FREEWHEEL="freewheel",n.CUSTOM="custom",n))(pt||{});var dr=(n=>(n[n.Disabled=0]="Disabled",n[n.Dryrun=1]="Dryrun",n))(dr||{});var Ws=typeof TextDecoder=="function"?new TextDecoder:void 0,zs=typeof TextEncoder=="function"?new TextEncoder:void 0,Kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Wn=Array.prototype.slice.call(Kn),Ys=(n=>{let e={};return n.forEach((t,r)=>e[t]=r),e})(Wn),Xs=String.fromCharCode.bind(String),Js=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):n=>new Uint8Array(Array.prototype.slice.call(n,0));var zn="__DVPUB_OT__",Yn=o(n=>zn+new URLSearchParams(n).toString().replace(/=/g,":").replace(/&/g,"|").replace(/\+/g,"%20").replace(/[^a-zA-Z0-9:|%_]/g,e=>`%${e.charCodeAt(0).toString(16)}`),"encodeParams"),Lr=o((n,e)=>Object.entries(e).reduce((r,[i,l])=>(r[`${n}${i}`]=l,r),{}),"prefixKeys"),Xn=o(n=>{let e={};for(let[t,r]of Object.entries(n))e[t]=`${r}`;return e},"stringifyValues"),Nr=o((n,e,t)=>{if(n==="custom"||n==="freewheel")return{};let r=Xn(xr(Ct({},e.passthroughParams),{dvp_uptpid:e.pageId,dvp_uptsid:e.slotId,dvp_uptsacnt:e.slotAdCount,dvp_qtpid:e.pageId})),i=Yn(Ct(Ct({},e.wrapperMode!=null?{m:String(e.wrapperMode)}:{}),Lr("_",r)));return n==="gam"?xr(Ct(Ct({dvpub_ot_params:i},e.wrapperMode!=null?{dv_upt_cwm:String(e.wrapperMode)}:{}),Lr("dv__",r)),{pts_pid:e.pageId,pts_sid:e.slotId}):n==="xandr"?{[t!=null?t:"pt1"]:i}:{}},"generateOmniTagTargeting");s();a();s();a();var A=class{constructor(){c(this,"timeFunction",new E.Map)}window(){return window}document(){return this.window().document}pageUrl(){var e,t;return(t=(e=this.window().location)==null?void 0:e.href)!=null?t:""}hostname(){return new URL(this.pageUrl()).hostname}time(){return this.timeFunction.conjure(this.core.session,()=>{let e=this.window(),t=!1;try{t=typeof e.performance.now()=="number"}catch(r){}return t?()=>Math.floor(e.performance.now()):()=>e.Date.now()})()}sendBeacon(e){try{let t=this.window().navigator;typeof(t==null?void 0:t.sendBeacon)=="function"?t.sendBeacon(e):new Image().src=e}catch(t){}}};o(A,"Env"),A=d([p],A);s();a();s();a();var C=class{constructor(){c(this,"plugins",{slotDiscovered:o((e,t)=>[],"slotDiscovered")});c(this,"slots",new E.Set)}getSlot(e,t){for(let r of this.slots)if(r.adServer===e&&r.elementId===t)return r}getSlots(e){let t=[...this.slots];return e==null?t:t.filter(r=>r.adServer===e)}createSlot(e,t,r,i,l,u){let m=this.getSlot(e,r);m!=null&&m.destroy();let v=E.Create({parent:this.core.session,adServer:e,elementId:r,adUnit:i,adServerConfig:l,uuid:De(),creationTime:Date.now()});return this.slots.add(v),u==null||u(v),this.plugins.slotDiscovered(v,t),v}};o(C,"SlotStore"),C=d([p],C);var Le=class{constructor(){c(this,"plugins",{adRemoved:o(e=>[],"adRemoved")})}_monitorAdRemoval(e){let t=this.core.get(A).document().getElementById(e.elementId);if(t==null)return;E.Create({parent:e,observer:new MutationObserver(i=>{let l=i.length,u=0,m=t.children.length;for(let v=i.length-1;v>=0;v--){let b=i[v];if(m===0){this.plugins.adRemoved(e);break}if(u===l-1)break;let D=b.removedNodes.length-b.addedNodes.length;m+=D,u++}})},({parent:i,observer:l})=>{l.disconnect(),this.plugins.adRemoved(i)}).observer.observe(t,{childList:!0})}};o(Le,"AdRemoved"),d([S(C,"slotDiscovered")],Le.prototype,"_monitorAdRemoval",1),Le=d([p],Le);var w=class{constructor(){c(this,"adEmpty",new E.Map);c(this,"adRequestInFlight",new E.Map);c(this,"nonEmptyAdResponses",new E.Map);c(this,"creatives",new E.Link);c(this,"plugins",{adRequested:o(e=>[],"adRequested"),adRequestedOrInferred:o(e=>[],"adRequestedOrInferred"),adRendered:o((e,t)=>[],"adRendered"),adRemoved:o(e=>[],"adRemoved")})}setAdRequested(e){this.adRequestInFlight.set(e,!0),this.plugins.adRequested(e),this.plugins.adRequestedOrInferred(e)}setAdRendered(e,t){this.adRequestInFlight.get(e)!==!0&&this.plugins.adRequestedOrInferred(e),this._setAdRemoved(e),this.adEmpty.set(e,!1),this.adRequestInFlight.set(e,!1),t!=null&&this.nonEmptyAdResponses.set(e,this.nonEmptyAdResponses.summon(e,0)+1);let r=null;if(t!=null){let i=this.core.get(A).time();r=E.Create(q({parent:e,timestamp:i},t)),this.creatives.get(e).add(r)}this.plugins.adRendered(e,r)}_setAdRemoved(e){if(this.adEmpty.get(e)===!1){this.adEmpty.set(e,!0);for(let t of this.creatives.get(e))t.destroy();this.plugins.adRemoved(e)}}getNonEmptyAdRenderedCount(e){return this.nonEmptyAdResponses.summon(e,0)}};o(w,"AdServerHub"),d([S(Le,"adRemoved")],w.prototype,"_setAdRemoved",1),w=d([p],w);s();a();s();a();var Ne=o((...n)=>{let e=[];for(let t of n)if(t!=null)for(let r of t)e.includes(r)||e.push(r);return e},"mergeUnique");var I=class{constructor(){c(this,"plugins",{getAdServerTargeting:o((e,t)=>[],"getAdServerTargeting"),setAdServerTargeting:o((e,t,r)=>[],"setAdServerTargeting")});c(this,"globalTargeting",{});c(this,"slotTargeting",new E.Map)}getGlobalTargeting(e){var t;return(t=this.globalTargeting[e])!=null?t:{}}_getSlotTargeting(e){return this.slotTargeting.summon(e,{})}_getTargetingKeys(e){return Ne(Object.keys(this.getGlobalTargeting(e.adServer)),Object.keys(this._getSlotTargeting(e)))}_getTargetingValues(e,t){return Ne(this.getGlobalTargeting(e.adServer)[t],this._getSlotTargeting(e)[t])}getTargeting(e){let t={};for(let r of this._getTargetingKeys(e))t[r]=this._getTargetingValues(e,r);return t}setSlotTargeting(e,t,r=!1){var u;let i=Object.keys(t),l=this._getSlotTargeting(e);for(let m of i)l[m]=Ne(t[m],r?(u=this.slotTargeting.get(e))==null?void 0:u[m]:null);this.setAdServerTargeting(e,i)}setGlobalTargeting(e,t,r=!1){var l,u;let i=Object.keys(t);for(let m of e){for(let v of i)(u=(l=this.globalTargeting)[m])!=null||(l[m]={}),this.globalTargeting[m][v]=Ne(t[v],r?this.globalTargeting[m][v]:null);for(let v of this.core.get(C).getSlots(m))this.setAdServerTargeting(v,i)}}getAdServerTargeting(e,t){var r;return(r=this.plugins.getAdServerTargeting(e,t).find(i=>i.length!==0))!=null?r:[]}setAdServerTargeting(e,t){t==null&&(t=this._getTargetingKeys(e));for(let r of t)this.plugins.setAdServerTargeting(e,r,this._getTargetingValues(e,r))}_onSlotDiscovered(e){this.setAdServerTargeting(e)}};o(I,"TargetingHub"),d([S(C,"slotDiscovered")],I.prototype,"_onSlotDiscovered",1),I=d([p],I);s();a();s();a();s();a();s();a();var kt=o(n=>{let e=n.renderedSize;return Array.isArray(e)?`${e[0]}x${e[1]}`:e},"toCreativeSizeString");s();a();var qt=o(n=>{switch(n){case"gpt":return"104";case"ast":return"90";default:return"0"}},"toAdServerCode");s();a();s();a();var Jn=[[/((\?)|&)(?:amp_lite|fr=operanews)/g,"$2"],[/(^https?:\/\/)(www\.)/g,"$1"],[/(((\?)|&|%3F|%26|;)(?:utm_campaign|utm_source|utm_content|utm_term|utm_viral|utm_medium|utm_identifier|utm_key|fb_source|referrer|referer|ref|rand|rnd|randid|\.?rand|\.?partner|cb|count|adid|session|sessionid|session_redirect|param\d|userinfo|uid|refresh|ocid|ncid|clickenc|fbclid|amp_js_v|amp_gsa|ns_source|ns_campaign|ns_mchanel|ns_mchannel|ns_linkname|ns_fee|src|ex_cid|usqp|source|xid|trkid|utm_social-type|mbid|utm_brand|__twitter_impression|utm_referrer|CMP|cmp|_cmp|cq_cmp)=[^&]*)/g,"$3"],[/[/.]amp(?:\/[?&]*)?$/g,""],[/((\?)|&)(?:outputType|isFollow|suppressMediaBar|cid|ICID|icid|bdk|wtu_id_h|utm_placement|intcmp|_native_ads|traffic_source|entry|\.tsrc|autoplay|autostart|dc_data|influencer|pubdate|utm_hp_ref|redirect|service|refresh_ce|refresh_cens|xcmg|target_id|_amp)=[^&]*/g,"$2"],[/(\?|&)(?:amp)(?:&|$|=[^&]*)/g,"$1"]],Zn=[[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""],[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""]],Mr=o((n,e)=>{for(let[t,r]of n)e=e.replace(t,r);return e},"replaceByRules"),Ur=o(n=>{let e=Mr(Jn,n);return Mr(Zn,e)},"normalizeUrl");s();a();var Fr=o(n=>n.split("?",1)[0].split("#",1)[0],"stripUrlQuery");s();a();var kr=o((n,e)=>{try{let t=new URLSearchParams(n),r=t.get("ctx"),i=t.get("cmp");if(r!=null&&i!=null)return{ctx:r,cmp:i,prefetch:e,legacy:!0}}catch(t){}return null},"parseInfo"),qr=o(n=>{var e;return n.pathname!=="/signals/pub.js"?null:(e=kr(n.search,!0))!=null?e:kr(n.hash.substring(1).split("?")[0],!1)},"parseLegacyPagetagUrl");var eo=1e3,to=/^\/dvtag\/([^/]+)\/([^/]+)\/pub\.js$/,x=class{constructor(){c(this,"visit");c(this,"tagInfo");c(this,"plugins",{newVisit:o(e=>[],"newVisit"),overrideTagInfo:o(e=>[],"overrideTagInfo")});c(this,"_normalizeUrl",Ur)}_initialize(){this.getTagInfo(),this.updateVisit(!1),this.plugins.newVisit(this.visit),this._installNavigationListener()}getTagInfo(){var e;if(this.tagInfo==null){try{this.tagInfo=this._parseTagInfo()}catch(r){}(e=this.tagInfo)!=null||(this.tagInfo={ctx:"unknown",cmp:"unknown"});let t=this.plugins.overrideTagInfo(this.tagInfo);t.length>0&&(this.tagInfo=q(q({},this.tagInfo),t[0]))}return this.tagInfo}_parseTagInfo(){let e=this.getCurrentScriptSrc();if(e==null)return null;let t=new URL(e,"https://pub.doubleverify.com"),r=t.pathname,i=to.exec(r);if(i!=null){let[,l,u]=i;return{ctx:l,cmp:u}}return qr(t)}getCurrentScriptSrc(){var e,t;return(t=(e=this.core.get(A).window().document.currentScript)==null?void 0:e.getAttribute("src"))!=null?t:null}getCurrentScriptBaseUrl(){let e=this.getCurrentScriptSrc();if(e==null)return null;try{let{origin:t,pathname:r}=new URL(e),i=r.split("/").slice(0,-1).join("/");return`${t}${i}/`}catch(t){return null}}updateVisit(e=!0){var r,i;let t=this.getStrippedPageUrl();if(this.visit==null||this.visit.strippedUrl!==t){let l=De();this.visit={strippedUrl:t,normalizedUrl:this._normalizeUrl(this.core.get(A).window().location.href),uuid:l,sessionUuid:(i=(r=this.visit)==null?void 0:r.sessionUuid)!=null?i:l},e&&this.plugins.newVisit(this.visit)}return this.visit}getVisit(){var e;return(e=this.visit)!=null?e:this.updateVisit(!1)}getStrippedPageUrl(){return Fr(this.core.get(A).window().location.href)}getNormalizedPageUrl(){return this.getVisit().normalizedUrl}getVisitUuid(){return this.getVisit().uuid}getSessionUuid(){return this.getVisit().sessionUuid}_installNavigationListener(){var r;let e=this.core.get(A).window(),t=o(()=>this.updateVisit(!0),"cb");((r=e.navigation)==null?void 0:r.addEventListener)!=null?e.navigation.addEventListener("navigatesuccess",t):setInterval(t,eo)}};o(x,"Context"),d([M],x.prototype,"_initialize",1),x=d([p],x);s();a();var $r=o(n=>{let e={};for(let[t,r]of Object.entries(n))r!=null&&(e[t]=typeof r=="string"?[r]:r);return e},"toTargeting");var ro={gpt:pt.GAM,ast:pt.XANDR,custom:pt.CUSTOM,"legacy-api":pt.CUSTOM},no="pt9",z=class{constructor(){c(this,"plugins",{disableCreativeWrapperMeasurement:o(e=>[],"disableCreativeWrapperMeasurement")});c(this,"targetingSet",new E.Map);c(this,"targetingReliable",new E.Map)}_setCreativeWrapperTargeting(e){if(e.adServer!=="gpt")return;let t=e.uuid,r=this.core.get(x).getVisitUuid(),i=this._getNextSlotAdCount(e),l=this.plugins.disableCreativeWrapperMeasurement(e).some(u=>u===!0)?dr.Disabled:void 0;this.core.get(I).setSlotTargeting(e,$r(Nr(ro[e.adServer],{slotId:t,pageId:r,slotAdCount:i,wrapperMode:l,passthroughParams:{dvp_uptacf:"1"}},no))),this.targetingSet.set(e,!0)}_onNewVisit(){let e=this.core.get(C).getSlots();for(let t of e)this._setCreativeWrapperTargeting(t)}_onAdRequested(e){this.targetingReliable.set(e,this.targetingSet.get(e)===!0)}isTargetingReliable(e){return e.adServer!=="gpt"?!0:this.targetingReliable.get(e)===!0}_getNextSlotAdCount(e){return this.core.get(w).getNonEmptyAdRenderedCount(e)+1}};o(z,"CreativeWrapperTargeting"),d([S(C,"slotDiscovered"),S(w,"adRendered")],z.prototype,"_setCreativeWrapperTargeting",1),d([S(x,"newVisit")],z.prototype,"_onNewVisit",1),d([S(w,"adRequested")],z.prototype,"_onAdRequested",1),z=d([p],z);s();a();s();a();s();a();s();a();var Ze=o(()=>(...n)=>[],"apiPlugin"),G=class{constructor(){c(this,"plugins",{queueAdRequest:Ze(),defineSlot:Ze(),adRendered:Ze(),adRemoved:Ze(),getTargeting:Ze(),addEventListener:o((e,t)=>[],"addEventListener"),removeEventListener:o((e,t)=>[],"removeEventListener"),toggleDebugMode:Ze(),_debugScriptLoaded:Ze()})}_initialize(){var r;let e=this.core.get(A).window(),t=(r=e.dvtag)!=null?r:{};e.dvtag=t,t.queueAdRequest=this.queueAdRequest,t.defineSlot=this.defineSlot,t.adRendered=this.adRendered,t.adRemoved=this.adRemoved,t.getTargeting=this.getTargeting,t.addEventListener=this.addEventListener,t.removeEventListener=this.removeEventListener,t.toggleDebugMode=this.toggleDebugMode,t._debugScriptLoaded=this._debugScriptLoaded}queueAdRequest(...e){this.plugins.queueAdRequest(...e)}defineSlot(...e){this.plugins.defineSlot(...e)}adRendered(...e){this.plugins.adRendered(...e)}adRemoved(...e){this.plugins.adRemoved(...e)}getTargeting(...e){var t;return(t=this.plugins.getTargeting(...e)[0])!=null?t:{}}addEventListener(e,t){this.plugins.addEventListener(e,t)}removeEventListener(e,t){this.plugins.removeEventListener(e,t)}toggleDebugMode(...e){this.plugins.toggleDebugMode(...e)}_debugScriptLoaded(...e){this.plugins._debugScriptLoaded(...e)}};o(G,"Api"),d([M],G.prototype,"_initialize",1),G=d([p],G);s();a();var ur=class ur{constructor(){c(this,"pending",[]);c(this,"flushing",!1)}push(e){this.pending.push(e),this.flush()}flush(){return R(this,null,function*(){var t;if(this.flushing)return;this.flushing=!0;let e=this.pending.shift();for(;e!=null;){try{yield e.promise}catch(r){}try{(t=e.callback)==null||t.call(e)}catch(r){}e=this.pending.shift()}this.flushing=!1})}};o(ur,"AsyncQueue");var $t=ur;var L=class{constructor(){c(this,"plugins",{adRequestQueued:o(e=>[],"adRequestQueued"),adRequestTimedOut:o(e=>[],"adRequestTimedOut"),adRequestBeforeRelease:o(e=>[],"adRequestBeforeRelease"),adRequestCompleted:o(e=>[],"adRequestCompleted")});c(this,"queue",new $t);c(this,"adRequestCounter",0)}_queueAdRequest(e={}){var l,u;let t={index:this.adRequestCounter++,status:"queued",timeoutValue:(l=e.timeout)!=null?l:0,onDvtagReadyCalled:(u=e.timestamp)!=null?u:0,waitingStarted:new Date().getTime(),internal:e.internal};this.core.get(x).updateVisit(),this.plugins.adRequestQueued(t);let r=e.callback;r===void 0?e.callback=()=>{}:r===null?t.status="tag-timeout":e.callback=()=>{t.status="queue-timeout",t.callbackCalled=new Date().getTime(),e.callback=null,this.plugins.adRequestTimedOut(t);try{r()}catch(m){}};let i=o(()=>{if(e.callback!=null){e.callback=null,t.status="success",t.callbackCalled=new Date().getTime(),this.plugins.adRequestBeforeRelease(t);try{r==null||r()}catch(m){}}else this.plugins.adRequestBeforeRelease(t);t.waitingEnded=new Date().getTime(),this.plugins.adRequestCompleted(t)},"onAsyncOperationsCompleted");this.queue.push({callback:i,adRequest:t})}delayAdRequests(e){this.queue.push({promise:e})}};o(L,"AdRequestQueue"),d([S(G,"queueAdRequest")],L.prototype,"_queueAdRequest",1),L=d([p],L);var Te=class{constructor(){c(this,"restoreCount",0)}getRestoreCount(){return this.restoreCount}_restoreTargeting(){let e=this.core.get(I);for(let t of this.core.get(C).getSlots()){if(t.adServer==="custom"||t.adServer==="legacy-api")continue;let r=e.getTargeting(t),i=Object.keys(r)[0];i!=null&&e.getAdServerTargeting(t,i).length===0&&(e.setAdServerTargeting(t),this.restoreCount+=1)}}};o(Te,"TargetingRestorer"),d([S(L,"adRequestQueued")],Te.prototype,"_restoreTargeting",1),Te=d([p],Te);s();a();s();a();var jt=o(n=>{if(typeof n=="string"||Array.isArray(n)&&n.length===2&&n.every(e=>typeof e=="number"))return n;if(n!=null&&typeof n.width=="number"&&typeof n.height=="number")return[n.width,n.height]},"cleanSizeInput");s();a();var te=o(n=>{if(typeof n=="string")return n;if(typeof n=="number")return`${n}`},"cleanStringInput");s();a();var ce=class{getPubAds(){var t,r;let e=this.core.get(A).window();try{return(r=(t=e.googletag)==null?void 0:t.pubads)==null?void 0:r.call(t)}catch(i){return}}onPubAdsReady(e){var i,l,u,m;let t=this.core.get(A).window();t.googletag=(i=t.googletag)!=null?i:{},t.googletag.cmd=(l=t.googletag.cmd)!=null?l:[];let r=this.getPubAds();if(r!=null)e(r);else try{(m=(u=t.googletag.cmd)==null?void 0:u.push)==null||m.call(u,()=>{r=this.getPubAds(),r!=null&&e(r)})}catch(v){}}};o(ce,"GoogletagPubAds"),ce=d([p],ce);s();a();s();a();var me=class{_getConfiguredAdServers(){try{return g}catch(e){return[]}}get(e,t){if(t!=null)return this._getConfiguredAdServers().find(r=>r.type===e&&r.adServerAccountId===t)}};o(me,"AdServerConfigs"),me=d([p],me);s();a();var gt=o(n=>{let e=n.split("/").map(i=>i.trim()).filter(i=>i.length>0);if(e.length<2)return;let t=e[0].split(",",1)[0],r=Number(t);return Number.isNaN(r)?void 0:`${r}`},"getNetworkCodeFromAdUnit");s();a();s();a();var ft=o(n=>{if(n==null)return[];let e=jr(n);return e!=null?[e]:Array.isArray(n)?n.map(jr).filter(t=>t!=null):[]},"parseSlotSizes"),jr=o(n=>{if(n==null)return null;if(typeof n=="string")return{label:n};if(Array.isArray(n)){if(n.length===1&&typeof n[0]=="string")return{label:n[0]};if(n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number")return{width:n[0],height:n[1]}}if(typeof n=="object"){let{label:e,width:t,height:r}=n;if(typeof t=="number"&&typeof r=="number")return{width:t,height:r};if(typeof e=="string")return{label:e}}return null},"parseSlotSize");s();a();var Br=o(n=>{try{return n.getSizes()}catch(e){return[]}},"getGptSlotSizesSafe");var Bt=o((n,e)=>{let t=n.getAdUnitPath(),r=gt(t);return{id:t,network:r,sizes:ft(Br(n)),position:e!=null?n.getTargeting(e)[0]:void 0}},"gptSlotToAdUnit");var re=class{constructor(){c(this,"gptReference",new E.Map)}_scanForSlots(){this.core.get(ce).onPubAdsReady(e=>{e.getSlots().map(t=>this.maybeDiscoverSlot(t,0))})}getGptSlot(e){return this.gptReference.get(e)}maybeDiscoverSlot(e,t){let r=this.core.get(C).getSlot("gpt",e.getSlotElementId());return r==null||this.gptReference.get(r)!==e?this._createSlot(e,t):r}_createSlot(e,t){let r=e.getSlotElementId(),i=e.getAdUnitPath(),l=gt(i),u=this.core.get(me).get("gpt",l),m=Bt(e,u==null?void 0:u.adPositionKey);return this.core.get(C).createSlot("gpt",t,r,m,u,b=>this.gptReference.set(b,e))}};o(re,"GoogletagSlots"),d([M,S(L,"adRequestQueued")],re.prototype,"_scanForSlots",1),re=d([p],re);var Ie=class{constructor(){c(this,"plugins",{adRequested:o(e=>[],"adRequested"),adRendered:o((e,t)=>[],"adRendered")})}_getHtmlSafe(e){var t,r;try{return(r=(t=e.getHtml)==null?void 0:t.call(e))!=null?r:void 0}catch(i){return}}_initialize(){this.core.get(ce).onPubAdsReady(e=>{e.addEventListener("slotRequested",t=>{let r=this.core.get(re).maybeDiscoverSlot(t.slot,1);this.plugins.adRequested(r)}),e.addEventListener("slotRenderEnded",t=>{let r=this.core.get(re).maybeDiscoverSlot(t.slot,2);if(t.isEmpty){this.plugins.adRendered(r,null);return}let i={type:"display",advertiserId:te(t.advertiserId),campaignId:te(t.campaignId),creativeId:te(t.creativeId),lineItemId:te(t.lineItemId),renderedSize:jt(t.size),html:this._getHtmlSafe(t.slot)};this.plugins.adRendered(r,i)})})}};o(Ie,"GoogletagEvents"),d([M],Ie.prototype,"_initialize",1),Ie=d([p],Ie);s();a();s();a();var cr=o(n=>typeof n=="string"||typeof n=="number"?[`${n}`]:n instanceof Array?Ne(n.filter(e=>typeof e=="string"||typeof e=="number").map(e=>`${e}`)):[],"cleanTargetingInput");var Me=class{getAdServerTargeting(e,t){var l,u,m;if(e.adServer!=="gpt")return[];let r=[];try{r=cr((u=(l=this.core.get(ce).getPubAds())==null?void 0:l.getTargeting)==null?void 0:u.call(l,t))}catch(v){}let i=[];try{i=cr((m=this.core.get(re).getGptSlot(e))==null?void 0:m.getTargeting(t))}catch(v){}return Ne(r,i)}setAdServerTargeting(e,t,r){var i;if(e.adServer==="gpt")try{(i=this.core.get(re).getGptSlot(e))==null||i.setTargeting(t,r)}catch(l){}}};o(Me,"GoogletagTargeting"),Me=d([p],Me);var Y=class{_onAdRequested(e){this.core.get(w).setAdRequested(e)}_onAdRendered(e,t){this.core.get(w).setAdRendered(e,t)}_getAdServerTargeting(e,t){return e.adServer!=="gpt"?[]:this.core.get(Me).getAdServerTargeting(e,t)}_setAdServerTargeting(e,t,r){e.adServer==="gpt"&&this.core.get(Me).setAdServerTargeting(e,t,r)}};o(Y,"Googletag"),d([S(Ie,"adRequested")],Y.prototype,"_onAdRequested",1),d([S(Ie,"adRendered")],Y.prototype,"_onAdRendered",1),d([S(I,"getAdServerTargeting")],Y.prototype,"_getAdServerTargeting",1),d([S(I,"setAdServerTargeting")],Y.prototype,"_setAdServerTargeting",1),Y=d([p,N(z),N(Te)],Y);s();a();s();a();s();a();s();a();s();a();var Gr=o((n,e)=>(e==null?void 0:e.structuredClone)!=null?e.structuredClone(n):JSON.parse(JSON.stringify(n)),"deepClone");s();a();s();a();var Vr=o(n=>{if(typeof n!="object"||n===null||Array.isArray(n))return!1;let e=n;return e.gdprApplies!==void 0&&typeof e.gdprApplies!="boolean"&&e.gdprApplies!==0&&e.gdprApplies!==1||e.eventStatus!=="tcloaded"&&e.eventStatus!=="cmpuishown"&&e.eventStatus!=="useractioncomplete"&&e.eventStatus!==void 0||e.tcString!==void 0&&typeof e.tcString!="string"?!1:e.gdprApplies===!1||e.gdprApplies===0||e.gdprApplies===void 0?!(e.tcString!==void 0||e.purpose!==void 0||e.vendor!==void 0||e.publisher!==void 0):!(typeof e.tcString!="string"||!io(e.purpose)||!so(e.vendor)||!ao(e.publisher))},"isValidTCData"),io=o(n=>{if(typeof n!="object"||n===null)return!1;let e=n;return Qt(e.consents)&&Qt(e.legitimateInterests)},"isValidPurposeObject"),so=o(n=>{if(typeof n!="object"||n===null)return!1;let e=n;return Qt(e.consents)&&Qt(e.legitimateInterests)},"isValidVendorObject"),ao=o(n=>{if(typeof n!="object"||n===null||n===void 0)return!1;let e=n;return!(e.restrictions!==void 0&&!lo(e.restrictions))},"isValidPublisherObject"),Qt=o(n=>typeof n!="object"||n===null?!1:Object.entries(n).every(([e,t])=>{let r=parseInt(e,10);return!isNaN(r)&&(typeof t=="boolean"||t===void 0)}),"isRecordOfBooleansOrUndefined"),lo=o(n=>typeof n!="object"||n===null?!1:Object.entries(n).every(([e,t])=>{let r=parseInt(e,10);return isNaN(r)||typeof t!="object"||t===null?!1:Object.entries(t).every(([i,l])=>{let u=parseInt(i,10),m=Number(l);return!isNaN(u)&&!isNaN(m)&&m>=0&&m<=3})}),"isValidPublisherRestrictions");var wt=126,Qr=2,uo=20,co=250;var be=class{constructor(){c(this,"firstResultPromise",new E.Map);c(this,"tcState",new E.Map);c(this,"declaredPurposes",new E.Map);c(this,"plugins",{signalReady:o(()=>[],"signalReady")})}getTcState(){return q({},this.tcState.conjure(this.core.session,()=>({apiAvailable:this._getCmpApi()!=null,applies:"",signalSettled:!1,tcString:""})))}getDeclaredPurposes(){return q({},this.declaredPurposes.conjure(this.core.session,()=>({purposes:[],flexiblePurposes:[2,7,8,10],legIntPurposes:[2,7,8,10]})))}getTcStateAsync(){return R(this,null,function*(){return yield this._getTcStatePromise(),this.getTcState()})}apiAvailable(){return this.getTcState().apiAvailable}applies(){let e=this.getTcState();return e.applies==="1"?!0:e.applies==="0"?!1:void 0}hasLegalBasis(e){let{applies:t,tcString:r,purpose:i,vendor:l}=this.getTcState();if(t!=="1"||r===""||i==null||l==null)return;let u=this._getActiveLegalBasis(e);if(u!=null)return u===0?!1:u===1?i.consents[e]===!0&&l.consent===!0:i.legitimateInterests[e]===!0&&l.legitimateInterest===!0}_getTcStatePromise(){return R(this,null,function*(){return this.firstResultPromise.conjure(this.core.session,()=>this._monitorTcState()).catch(()=>{})})}_monitorTcState(){return R(this,null,function*(){let e=yield this._getCmpApiAsync();if(e!=null){try{e("getVendorList",Qr,(t,r)=>{var i;if(r===!0&&((i=t==null?void 0:t.vendors)==null?void 0:i[wt])!=null){let{purposes:l,flexiblePurposes:u,legIntPurposes:m}=t.vendors[wt];this._setDeclaredPurposes({purposes:l,flexiblePurposes:u,legIntPurposes:m})}})}catch(t){}yield new Promise(t=>{try{e("addEventListener",Qr,(r,i)=>{i===!0&&Vr(r)&&this._setTcState(r),t()})}catch(r){t()}})}})}_getCmpApiAsync(){return R(this,null,function*(){let e=this.core.get(A).window(),t=this._getCmpApi(),r=0;for(;t==null&&r<uo;)r++,yield new Promise(i=>e.setTimeout(i,co)),t=this._getCmpApi();return t})}_getCmpApi(){let t=this.core.get(A).window().__tcfapi;if(typeof t=="function")return t}_setDeclaredPurposes(e){this.declaredPurposes.set(this.core.session,{purposes:[...e.purposes],flexiblePurposes:[...e.flexiblePurposes],legIntPurposes:[...e.legIntPurposes]})}_setTcState(e){let t=this._convertTcDataToTcState(e);this.tcState.set(this.core.session,t),t.signalSettled&&this.plugins.signalReady()}_convertTcDataToTcState(e){let t=e.gdprApplies==null?"":e.gdprApplies===!0||e.gdprApplies===1?"1":"0",r=e.eventStatus==="tcloaded"||e.eventStatus==="useractioncomplete"||t==="0",i={apiAvailable:!0,applies:t,signalSettled:r,tcString:""};return!(e.gdprApplies===!0||e.gdprApplies===1)||e.tcString===""?i:Xe(q({},i),{tcString:e.tcString,purpose:Gr(e.purpose),vendor:{legitimateInterest:e.vendor.legitimateInterests[wt]===!0,consent:e.vendor.consents[wt]===!0},publisherRestrictions:this._extractDvRestrictions(e.publisher.restrictions)})}_extractDvRestrictions(e){let t={};for(let[r,i]of Object.entries(e)){let l=i[wt];l!=null&&(t[Number(r)]=l)}return t}_getActiveLegalBasis(e){let t=this.getDeclaredPurposes(),{publisherRestrictions:r}=this.getTcState();if(r==null)return;let i=r[e];if(i===0)return 0;let l=t.legIntPurposes.includes(e)?2:t.purposes.includes(e)?1:0;if(l===0)return 0;if(i===1||i===2){let u=i===1?1:2,m=t.flexiblePurposes.includes(e);return l===u||m?u:0}return l}};o(be,"Gdpr"),d([M],be.prototype,"_getTcStatePromise",1),be=d([p],be);s();a();var ne=class{getShortCommitId(){return"0e7d1c2"}getBuildTimestamp(){return 1763391633899}getAuthToken(){return"Qc3GgI55g66srbD2O+DkAOz/5KHgJcG3Uw6lsrTrTjHJ2ksQl76DBNSYWLzxUuTCMYhFgNp30W7GG1vzFp1JzAeAlYuPnzon5tRBTfuu5CZ+GtiJRqkneo1D1zVnbhHf51PHFRTQgm+g8sX4XOFligJ3PFhPEeE="}};o(ne,"DefinedVariables"),ne=d([p],ne);s();a();var mo="https://vtrk.doubleverify.com",Hr="dvtag",po=1,F=class{constructor(){c(this,"sharedDataPoints")}_onAdRequestCompleted(e){if(e.index!==0)return;let{timeoutValue:t,onDvtagReadyCalled:r,callbackCalled:i}=e,l=i!=null?i-r:t,{applies:u,apiAvailable:m}=this.core.get(be).getTcState();this.fireEvent("ad-request",{cd111:e.status,cm106:e.index,cm107:l,cd112:e.internal?"legacy":"modern",cd115:u,cm116:m?1:0},{sampleInterval:po})}_getSharedDataPoints(){if(this.sharedDataPoints==null){let e=this.core.get(x),t=this.core.get(ne),r=this.core.get(A),{ctx:i,cmp:l,legacy:u}=e.getTagInfo(),m=r.hostname(),v=e.getSessionUuid(),b=t.getShortCommitId();this.sharedDataPoints={cd102:b,cd103:"",cd107:v,cd109:u?"legacy":"modern",cd108:"",cd105:i,cd106:l,cd104:m}}return this.sharedDataPoints}fireEvent(e,t,{sampleInterval:r=1,trackerUuid:i=De(),spoofWrapperId:l=!1}={}){if(Math.random()>=1/r)return;t=Xe(q(q({},t),this._getSharedDataPoints()),{cd101:e,cm101:r});let u=Xe(q({ec:Hr,ea:t.cd101,ctx:l?Hr:t.cd105,cmp:t.cd106},t),{cid:i,t:"event",v:1,z:i,cd160:i}),m=new URL(mo);for(let[v,b]of Object.entries(u))b!=null&&m.searchParams.set(v,`${b}`);this.core.get(A).sendBeacon(m.href)}};o(F,"Events"),d([S(L,"adRequestCompleted")],F.prototype,"_onAdRequestCompleted",1),F=d([p],F);s();a();var go=.01,Re=class{constructor(){c(this,"plugins",{overrideActivationRate:o(()=>[],"overrideActivationRate")});c(this,"_random",Math.random);c(this,"_falconEnabled")}isFalconEnabled(){var e;if(this._falconEnabled==null){let t=(e=this.plugins.overrideActivationRate()[0])!=null?e:go;this._falconEnabled=this._random()<t}return this._falconEnabled}};o(Re,"FalconTest"),Re=d([p],Re);s();a();s();a();s();a();var Kr=10,H=class{constructor(){c(this,"errors",new E.Map)}_getErrors(){return this.errors.summon(this.core.session,[])}toSafeCallback(e){return(...t)=>this._callSafely(e,t)}_callSafely(e,t){return e(...t)}_handleError(e,t){let r=this._getErrors(),i=t.join("=>");if(r.unshift(`${e}: ${i}`),r.length>Kr){r.length=Kr;return}this.core.get(F).fireEvent("log",{cd111:"error",cd112:e,cd113:i})}};o(H,"ErrorHandler"),d([de],H.prototype,"_callSafely",1),d([lr],H.prototype,"_handleError",1),H=d([p],H);var oe=class{observe(e,t,r,i,...l){let u=this.core.get(H).toSafeCallback(i),m=new t(u,...l);return m.observe(r),E.Create({parent:e},()=>{m.disconnect()})}addEventListener(e,t,r,i){let l=this.core.get(H).toSafeCallback(i);return t.addEventListener(r,l),E.Create({parent:e},()=>{t.removeEventListener(r,l)})}};o(oe,"Subscriptions"),oe=d([p],oe);var fo=5e3,$=class{constructor(){c(this,"plugins",{pageVisible:o(()=>[],"pageVisible"),pageHide:o(()=>[],"pageHide"),pageHideThrottled:o(()=>[],"pageHideThrottled")});c(this,"hidden",new E.Map);c(this,"lastFiredThrottled",new E.Map)}_initialize(){this._installListeners(),this._maybeFirePlugins()}_installListeners(){let e=this.core.get(A).window(),t=this.core.get(A).document();this.core.get(oe).addEventListener(this.core.session,t,"visibilitychange",()=>this._maybeFirePlugins());for(let r of["pagehide","pageshow"])this.core.get(oe).addEventListener(this.core.session,e,r,()=>this._maybeFirePlugins())}isHidden(){var e,t;return((e=this.isDocumentHidden())!=null?e:!1)||((t=this.isDocumentVisibilityStateHidden())!=null?t:!1)}isDocumentHidden(){try{return this.core.get(A).document().hidden===!0}catch(e){return}}isDocumentVisibilityStateHidden(){try{let e=this.core.get(A).document().visibilityState;return typeof e=="string"&&e==="hidden"}catch(e){return}}documentHasFocus(){try{return this.core.get(A).document().hasFocus()===!0}catch(e){return}}_maybeFirePlugins(){let e=this.hidden.get(this.core.session),t=this.isHidden();if(this.hidden.set(this.core.session,t),e!==t&&this.plugins[t?"pageHide":"pageVisible"](),t){let r=this.core.get(A).time(),i=this.lastFiredThrottled.get(this.core.session);if(i!=null&&r-i<=fo)return;this.lastFiredThrottled.set(this.core.session,r),this.plugins.pageHideThrottled()}}};o($,"PageVisibility"),d([M],$.prototype,"_initialize",1),$=d([p],$);s();a();var X=class{setTimeout(e,t,r,i=!1){let l=this.core.get(A).window(),u=this.core.get(H).toSafeCallback(t),m=o(()=>{u(),m=o(()=>{},"callbackOnce")},"callbackOnce"),v=E.Create({parent:e},()=>{l.clearTimeout(b),i&&m()}),b=l.setTimeout(()=>{m(),v.destroy()},r);return v}setInterval(e,t,r,i=!1){let l=this.core.get(A).window(),u=this.core.get(H).toSafeCallback(t),m=l.setInterval(u,r);return E.Create({parent:e},()=>{l.clearInterval(m),i&&u()})}entityExistsAfterTimeout(e,t){return new Promise(r=>{E.Create({parent:this.setTimeout(e,()=>r(!0),t)},()=>r(!1))})}};o(X,"Timeouts"),X=d([p],X);s();a();var _e=class{constructor(){c(this,"_count",0);c(this,"plugins",{onCountUpdated:o(e=>[],"onCountUpdated")})}getCount(){return this._count}increment(){this._count+=1,this.plugins.onCountUpdated(this._count)}decrement(){this._count-=1,this.plugins.onCountUpdated(this._count)}};o(_e,"MeasurementScriptCounter"),_e=d([p],_e);var ho="blockingtime",vo=5*60*1e3,So=60*1e3,Eo=20;var ie=class{constructor(){c(this,"monitors",new E.Set);c(this,"state",new E.Map)}_getMonitor(){return this.monitors.conjure(()=>E.Create({parent:this.core.session}))}_getState(){return this.state.conjure(this._getMonitor(),()=>({trackerCount:0,monitorStart:0,lastAvgScriptCountUpdate:0,summedBlockingTime:0,totalLongTaskTime:0,longTaskCount:0,avgScriptCountNumerator:0,currentScriptCount:0,lastTrackerSent:void 0,scriptInsertions:0}))}_initialize(){var l;let e=this.core.get(A),t=this._getMonitor(),r=this._getState();r.monitorStart=e.time(),r.lastAvgScriptCountUpdate=e.time();let{PerformanceObserver:i}=e.window();i==null||((l=i.supportedEntryTypes)==null?void 0:l.includes("longtask"))!==!0||(this.core.get(oe).observe(t,i,{type:"longtask",buffered:!0},this._onPerformanceObserverEntryList),this.core.get(X).setTimeout(t,this._onMonitoringWindowClosed,vo))}_onPerformanceObserverEntryList(e){let t=this._getState();e.getEntries().forEach(r=>{let i=Math.max(0,r.duration-50);t.totalLongTaskTime+=r.duration,t.longTaskCount+=1,t.summedBlockingTime+=i})}_onMonitoringWindowClosed(){this._sendTracker(),this._getMonitor().destroy()}_onScriptCountUpdate(e){let t=this._getState();t.scriptInsertions+=e>t.currentScriptCount?1:0,this._updateAvgScriptCount(),t.currentScriptCount=e}_updateAvgScriptCount(){let e=this._getState();e.avgScriptCountNumerator+=e.currentScriptCount*(this.core.get(A).time()-e.lastAvgScriptCountUpdate),e.lastAvgScriptCountUpdate=this.core.get(A).time()}_sendTracker(){let e=this._getState();if(e.lastTrackerSent!=null&&this.core.get(A).time()-e.lastTrackerSent<So)return;this._updateAvgScriptCount();let t=this.core.get(A).time()-e.monitorStart,r={cd110:this.core.get(Re).isFalconEnabled()?"falcon":"cdn",cm106:e.trackerCount,cm107:t,cm108:e.summedBlockingTime,cm109:e.totalLongTaskTime,cm110:e.longTaskCount,cm111:e.avgScriptCountNumerator/t,cm112:e.scriptInsertions};this.core.get(F).fireEvent(ho,r,{spoofWrapperId:!0}),e.trackerCount+=1,e.lastTrackerSent=this.core.get(A).time(),e.trackerCount>=Eo&&this._getMonitor().destroy()}};o(ie,"BlockingTimeMonitor"),d([M],ie.prototype,"_initialize",1),d([de],ie.prototype,"_onPerformanceObserverEntryList",1),d([de],ie.prototype,"_onMonitoringWindowClosed",1),d([S(_e,"onCountUpdated")],ie.prototype,"_onScriptCountUpdate",1),d([S($,"pageHideThrottled")],ie.prototype,"_sendTracker",1),ie=d([p],ie);s();a();s();a();s();a();var Ht=o((n,e,t="")=>{if(n.length<=e)return n;let r=e-t.length;return r<0?t:n.slice(0,r)+t},"truncate");s();a();var Wr="https://cdn.doubleverify.com/dvtp_src.js",zr="https://cdn.dv.tech/dvbm.js";s();a();var Yr={cmp:"cmp",ctx:"ctx",isSellerTag:"seltag",blocking:"blk",t2te:"t2te",deepIFrameClickHandlers:"dich",measurementActivationPath:"dvp_pubaap",unityTagBuildTimestamp:"dvp_uptbts",unityTagBuildCommitId:"dvp_uptbcid",gdprApplies:"gdpr",gdprTcString:"gdpr_consent",adServerCode:"adsrv",adServerId:"dvp_gptmasid",pageVisitId:"dvp_uptpid",slotId:"dvp_uptsid",slotElementId:"dvp_uptseid",selectedVariation:"dvp_gptmvr",selectedVariationFraction:"dvp_gptmvrfr",customDimension1:"c1",customDimension2:"c2",customDimension3:"c3",customDimension4:"c4",customDimension5:"c5",customDimension6:"c6",customDimension7:"c7",customDimension8:"c8",customDimension9:"c9",customDimension10:"c10",adPosition:"spos",qtPageId:"dvp_qtpid",qtSlotId:"dvp_qtsid",qtObservabilityIDS:"mpt_pub_qtids",qtObservabilityBSCPageLevel:"mpt_pub_qtbscpl",headerBidding:"dvp_gptmhb",advertiserId:"sadv",orderId:"ord",lineItemId:"litm",creativeId:"scrt",placementCode:"splc",size:"unit",slotAdCount:"dvp_uptsacnt",locatedElementType:"dvp_gptmle",adLocationMechanism:"alm",usedAdFormat:"dvp_pubuaf",adFormatName:"mpt_pub_afn",adDetectionDiagnostics:"dvp_pubadd",adLocatingDiagnostics:"dvp_pubald",adContainerSelector:"mpt_pub_acs",creativeWrapperAvailable:"dvp_gptmcw",isFalconTestEnabledDVP:"dvp_pubaft",isFalconTestEnabledEE:"ee_dp_pubaft",measurementInjectionStrategy:"dvp_gptmit"};var k=class{constructor(){c(this,"parameters",new E.Map);c(this,"_truncate",Ht)}_set(e,t){var r;this.parameters.set(e,q(q({},(r=this.parameters.get(e))!=null?r:{}),t))}_getScriptUrl(e){let t=[],r=this.parameters.summon(e,{});for(let[i,l]of Object.entries(r)){let u=Yr[i];l!=null&&t.push([u,encodeURIComponent(l)])}return`${this.core.get(Re).isFalconEnabled()?zr:Wr}#${t.map(([i,l])=>`${i}=${l}`).join("&")}`}createScriptElement(e,t){let r=this._getScriptUrl(e),l=this.core.get(A).document().createElement("script");return l.setAttribute("src",r),l.setAttribute("async",""),l.dvAdElement=t,l}setIdentifiers(e){let{ctx:t,cmp:r}=this.core.get(x).getTagInfo();this._set(e,{ctx:t,cmp:r})}setConstants(e){this._set(e,{isSellerTag:1,t2te:0,blocking:this.core.get(Re).isFalconEnabled()?0:void 0,measurementActivationPath:2,deepIFrameClickHandlers:1,unityTagBuildTimestamp:this.core.get(ne).getBuildTimestamp(),unityTagBuildCommitId:this.core.get(ne).getShortCommitId()})}setGdpr(e){let t=this.core.get(be),{applies:r,tcString:i}=t.getTcState();this._set(e,{gdprApplies:r,gdprTcString:i})}setAdUnit(e){var t;this._set(e,{adServerCode:qt(e.adServer),adServerId:(t=e.adServerConfig)==null?void 0:t.adServerId,pageVisitId:this.core.get(x).getVisitUuid(),slotId:e.uuid,slotElementId:this._truncate(e.elementId,30,"~")})}_getCustomDimension(e,t){var l,u,m;let i=(m=((u=(l=e.adServerConfig)==null?void 0:l.customTracking)!=null?u:{})[t])==null?void 0:m.key;return i!=null?this.core.get(I).getAdServerTargeting(e,i).join(","):void 0}setCustomDimensions(e){this._set(e,{customDimension1:this._getCustomDimension(e,"c1"),customDimension2:this._getCustomDimension(e,"c2"),customDimension3:this._getCustomDimension(e,"c3"),customDimension4:this._getCustomDimension(e,"c4"),customDimension5:this._getCustomDimension(e,"c5"),customDimension6:this._getCustomDimension(e,"c6"),customDimension7:this._getCustomDimension(e,"c7"),customDimension8:this._getCustomDimension(e,"c8"),customDimension9:this._getCustomDimension(e,"c9"),customDimension10:this._getCustomDimension(e,"c10")})}_getAdPosition(e){var r;let t=(r=e.adServerConfig)==null?void 0:r.adPositionKey;if(t!=null)return this.core.get(I).getAdServerTargeting(e,t)[0]}setQualityTargeting(e){this._set(e,{adPosition:this._getAdPosition(e),qtPageId:this.core.get(x).getVisitUuid(),qtSlotId:e.uuid})}setQtObservability(e,{bscPageLevel:t,ids:r}){this._set(e,{qtObservabilityBSCPageLevel:t,qtObservabilityIDS:r})}setAdInstance(e,t){this._set(e,{advertiserId:t.advertiserId,orderId:t.campaignId,lineItemId:t.lineItemId,creativeId:t.creativeId,placementCode:e.adUnit.id,size:kt(t)})}setEngagement(e){this._set(e,{slotAdCount:this.core.get(w).getNonEmptyAdRenderedCount(e)})}_getLocatedElementType(e){let{sameOriginIframe:t,crossOriginIframe:r}=e;return t!=null?1:r!=null?2:0}setAdLocation(e,t){this._set(e,{locatedElementType:this._getLocatedElementType(t),adLocationMechanism:"manual"})}setDetectedAdFormat(e,t){t!=null&&this._set(e,q({},t))}setDebug(e){this._set(e,{isFalconTestEnabledDVP:1,isFalconTestEnabledEE:1,measurementInjectionStrategy:0})}};o(k,"MeasurementScript"),k=d([p],k);var yo="80000200",Ue=class{_onAdRequested(e){var l,u;let t=this.core.get(I).getTargeting(e),r=null;((l=t.IDS)==null?void 0:l.length)>0&&(r=t.IDS[0]==="1"?1:0);let i=null;((u=t.BSC)==null?void 0:u.length)>0&&(i=this._isPageLevelBsc(t.BSC)?1:0),this.core.get(k).setQtObservability(e,{ids:r,bscPageLevel:i})}_isPageLevelBsc(e){return!e.includes(yo)}};o(Ue,"QtObservability"),d([S(w,"adRequestedOrInferred")],Ue.prototype,"_onAdRequested",1),Ue=d([p],Ue);s();a();s();a();s();a();s();a();s();a();s();a();s();a();var Xr=o((n,e)=>{let t=null;try{t=n.contentDocument}catch(r){}if(t==null)return!1;if(n.src===""||n.src==="about:blank")return!0;try{return new URL(n.src).origin===new URL(e).origin}catch(r){return!1}},"isIframeSameOrigin");var Jr={gpt:"google_ads_iframe_",ast:"utif_"},je=class{constructor(){c(this,"_isIframeSameOrigin",Xr)}_getIframeDocument(e){try{return e.contentDocument}catch(t){return null}}_findIframe(e,t){if(Jr[t]==null)return null;let i=e.querySelectorAll(`iframe[id^="${Jr[t]}"]`);return i.length===1?i[0]:null}getAdContainer(e,t){if((t==null?void 0:t.type)!=="display")return{};let{elementId:r,adServer:i}=e,u=this.core.get(A).document().getElementById(r);if(u==null)return{};let m=this._findIframe(u,i);if(m==null)return{slotElement:u};let v=this._getIframeDocument(m);return this._isIframeSameOrigin(m,this.core.get(A).pageUrl())?{slotElement:u,sameOriginIframe:m,sameOriginIframeDocument:v}:{slotElement:u,crossOriginIframe:m}}};o(je,"AdLocator"),je=d([p],je);s();a();s();a();(function(n){typeof define=="function"&&define.amd?define(n):n()})(function(){"use strict";function n(h,y){(y==null||y>h.length)&&(y=h.length);for(var T=0,_=Array(y);T<y;T++)_[T]=h[T];return _}o(n,"_arrayLikeToArray");function e(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}o(e,"_assertThisInitialized");function t(h,y,T){return y=v(y),V(h,D()?Reflect.construct(y,T||[],v(h).constructor):y.apply(h,T))}o(t,"_callSuper");function r(h,y){if(!(h instanceof y))throw new TypeError("Cannot call a class as a function")}o(r,"_classCallCheck");function i(h,y){for(var T=0;T<y.length;T++){var _=y[T];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(h,At(_.key),_)}}o(i,"_defineProperties");function l(h,y,T){return y&&i(h.prototype,y),T&&i(h,T),Object.defineProperty(h,"prototype",{writable:!1}),h}o(l,"_createClass");function u(h,y){var T=typeof Symbol!="undefined"&&h[Symbol.iterator]||h["@@iterator"];if(!T){if(Array.isArray(h)||(T=Zt(h))||y&&h&&typeof h.length=="number"){T&&(h=T);var _=0,P=o(function(){},"F");return{s:P,n:o(function(){return _>=h.length?{done:!0}:{done:!1,value:h[_++]}},"n"),e:o(function(Ee){throw Ee},"e"),f:P}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j,$e=!0,Se=!1;return{s:o(function(){T=T.call(h)},"s"),n:o(function(){var Ee=T.next();return $e=Ee.done,Ee},"n"),e:o(function(Ee){Se=!0,j=Ee},"e"),f:o(function(){try{$e||T.return==null||T.return()}finally{if(Se)throw j}},"f")}}o(u,"_createForOfIteratorHelper");function m(){return m=typeof Reflect!="undefined"&&Reflect.get?Reflect.get.bind():function(h,y,T){var _=Q(h,y);if(_){var P=Object.getOwnPropertyDescriptor(_,y);return P.get?P.get.call(arguments.length<3?h:T):P.value}},m.apply(null,arguments)}o(m,"_get");function v(h){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},v(h)}o(v,"_getPrototypeOf");function b(h,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(y&&y.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),Object.defineProperty(h,"prototype",{writable:!1}),y&&U(h,y)}o(b,"_inherits");function D(){try{var h=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(y){}return(D=o(function(){return!!h},"_isNativeReflectConstruct"))()}o(D,"_isNativeReflectConstruct");function V(h,y){if(y&&(typeof y=="object"||typeof y=="function"))return y;if(y!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e(h)}o(V,"_possibleConstructorReturn");function U(h,y){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(T,_){return T.__proto__=_,T},U(h,y)}o(U,"_setPrototypeOf");function Q(h,y){for(;!{}.hasOwnProperty.call(h,y)&&(h=v(h))!==null;);return h}o(Q,"_superPropBase");function ve(h,y,T,_){var P=m(v(1&_?h.prototype:h),y,T);return 2&_&&typeof P=="function"?function(j){return P.apply(T,j)}:P}o(ve,"_superPropGet");function Jt(h,y){if(typeof h!="object"||!h)return h;var T=h[Symbol.toPrimitive];if(T!==void 0){var _=T.call(h,y||"default");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(y==="string"?String:Number)(h)}o(Jt,"_toPrimitive");function At(h){var y=Jt(h,"string");return typeof y=="symbol"?y:y+""}o(At,"_toPropertyKey");function Zt(h,y){if(h){if(typeof h=="string")return n(h,y);var T={}.toString.call(h).slice(8,-1);return T==="Object"&&h.constructor&&(T=h.constructor.name),T==="Map"||T==="Set"?Array.from(h):T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T)?n(h,y):void 0}}o(Zt,"_unsupportedIterableToArray"),function(h){return{NativeAbortSignal:h.AbortSignal,NativeAbortController:h.AbortController}}(typeof self!="undefined"?self:global);function Lt(h){var y;try{y=new Event("abort")}catch(T){typeof document!="undefined"?document.createEvent?(y=document.createEvent("Event"),y.initEvent("abort",!1,!1)):(y=document.createEventObject(),y.type="abort"):y={type:"abort",bubbles:!1,cancelable:!1}}return y.reason=h,y}o(Lt,"createAbortEvent");function qe(h){if(h===void 0)if(typeof document=="undefined")h=new Error("This operation was aborted"),h.name="AbortError";else try{h=new DOMException("signal is aborted without reason"),Object.defineProperty(h,"name",{value:"AbortError"})}catch(y){h=new Error("This operation was aborted"),h.name="AbortError"}return h}o(qe,"normalizeAbortReason");var Tt=function(){function h(){r(this,h),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return o(h,"Emitter"),l(h,[{key:"addEventListener",value:o(function(T,_,P){T in this.listeners||(this.listeners[T]=[]),this.listeners[T].push({callback:_,options:P})},"addEventListener")},{key:"removeEventListener",value:o(function(T,_){if(T in this.listeners){for(var P=this.listeners[T],j=0,$e=P.length;j<$e;j++)if(P[j].callback===_){P.splice(j,1);return}}},"removeEventListener")},{key:"dispatchEvent",value:o(function(T){var _=this;if(T.type in this.listeners){for(var P=this.listeners[T.type],j=P.slice(),$e=o(function(){var ye=j[Se];try{ye.callback.call(_,T)}catch(Mt){Promise.resolve().then(function(){throw Mt})}ye.options&&ye.options.once&&_.removeEventListener(T.type,ye.callback)},"_loop"),Se=0,Ee=j.length;Se<Ee;Se++)$e();return!T.defaultPrevented}},"dispatchEvent")}])}(),lt=function(h){function y(){var T;return r(this,y),T=t(this,y),T.listeners||Tt.call(T),Object.defineProperty(T,"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(T,"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(T,"reason",{value:void 0,writable:!0,configurable:!0}),T}return o(y,"AbortSignal"),b(y,h),l(y,[{key:"toString",value:o(function(){return"[object AbortSignal]"},"toString")},{key:"dispatchEvent",value:o(function(_){_.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,_)),ve(y,"dispatchEvent",this,3)([_])},"dispatchEvent")},{key:"throwIfAborted",value:o(function(){var _=this.aborted,P=this.reason,j=P===void 0?"Aborted":P;if(_)throw j},"throwIfAborted")}],[{key:"timeout",value:o(function(_){var P=new Ye;return setTimeout(function(){return P.abort(new DOMException("This signal is timeout in ".concat(_,"ms"),"TimeoutError"))},_),P.signal},"timeout")},{key:"any",value:o(function(_){var P=new Ye;function j(){P.abort(this.reason),$e()}o(j,"abort");function $e(){var ye=u(_),Mt;try{for(ye.s();!(Mt=ye.n()).done;){var wn=Mt.value;wn.removeEventListener("abort",j)}}catch(Dn){ye.e(Dn)}finally{ye.f()}}o($e,"clean");var Se=u(_),Ee;try{for(Se.s();!(Ee=Se.n()).done;){var Nt=Ee.value;if(Nt.aborted){P.abort(Nt.reason);break}else Nt.addEventListener("abort",j)}}catch(ye){Se.e(ye)}finally{Se.f()}return P.signal},"any")}])}(Tt),Ye=function(){function h(){r(this,h),Object.defineProperty(this,"signal",{value:new lt,writable:!0,configurable:!0})}return o(h,"AbortController"),l(h,[{key:"abort",value:o(function(T){var _=qe(T),P=Lt(_);this.signal.reason=_,this.signal.dispatchEvent(P)},"abort")},{key:"toString",value:o(function(){return"[object AbortController]"},"toString")}])}();typeof Symbol!="undefined"&&Symbol.toStringTag&&(Ye.prototype[Symbol.toStringTag]="AbortController",lt.prototype[Symbol.toStringTag]="AbortSignal");function er(h){return h.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof h.Request=="function"&&!h.Request.prototype.hasOwnProperty("signal")||!h.AbortController}o(er,"polyfillNeeded"),function(h){er(h)&&(h.AbortController=Ye,h.AbortSignal=lt)}(typeof self!="undefined"?self:global)});s();a();var Ao=(n=>(n[n.DEFAULT=0]="DEFAULT",n[n.WEATHER_CHANNEL_LWIM=1]="WEATHER_CHANNEL_LWIM",n[n.CELTRA=2]="CELTRA",n[n.CLIPCENTRIC=4]="CLIPCENTRIC",n[n.WEATHER_CHANNEL_MWIM=8]="WEATHER_CHANNEL_MWIM",n[n.ANNOTATION=16]="ANNOTATION",n))(Ao||{}),ht,To=(ht=class{constructor(){c(this,"annotation")}setAnnotation(e){return this.annotation=e,this}getAnnotation(){return this.annotation}},o(ht,"L"),ht),bo=(n=>(n[n.NO_ERROR=0]="NO_ERROR",n[n.UNKNOWN_ERROR=1]="UNKNOWN_ERROR",n[n.NO_AD_FOUND=4]="NO_AD_FOUND",n[n.MULTIPLE_ADS_LOCATED=8]="MULTIPLE_ADS_LOCATED",n[n.ABORTED=16]="ABORTED",n))(bo||{}),vt,Pe=(vt=class extends Error{constructor(t,r,i){super(r,i);c(this,"errorCode");this.errorCode=t}},o(vt,"c"),vt),Ro=o(n=>n instanceof Pe?n:n instanceof DOMException&&(n.name==="AbortError"||n.name==="TimeoutError")?new Pe(16,n.message,{cause:n}):n instanceof Error?new Pe(1,n.message,{cause:n}):new Pe(1,String(n)),"b"),mr=(n=>(n.AD_LOCATED="AD_LOCATED",n.AD_LOCATION_FAILED="AD_LOCATION_FAILED",n))(mr||{}),_o=(n=>(n[n.NO_ERROR=0]="NO_ERROR",n[n.UNKNOWN_ERROR=1]="UNKNOWN_ERROR",n[n.MULTIPLE_AD_FORMATS_DETECTED=2]="MULTIPLE_AD_FORMATS_DETECTED",n[n.DOM_EXCEPTION=4]="DOM_EXCEPTION",n))(_o||{}),St,Fe=(St=class extends Error{constructor(t,r,i){super(r,i);c(this,"errorCode");this.errorCode=t}},o(St,"m"),St),Zr=o(n=>n instanceof Fe?n:n instanceof Error?new Fe(1,n.message,{cause:n}):new Fe(1,String(n)),"O"),Co=(n=>(n.DETECTED="DETECTED",n.NOT_DETECTED="NOT_DETECTED",n.DETECTION_FAILED="DETECTION_FAILED",n))(Co||{}),Dt=o(n=>{let e={name:n.name,id:n.id,detect:o((...t)=>{try{let r=n.detect(...t);return r==null?{type:"NOT_DETECTED",adFormat:e}:{type:"DETECTED",adFormat:e,locate:o(i=>R(void 0,null,function*(){let l=new To;try{let u=yield r(l,i);return{type:"AD_LOCATED",adFormat:e,adNode:u,annotation:l.getAnnotation()}}catch(u){let m=Ro(u);return{type:"AD_LOCATION_FAILED",adFormat:e,error:m,annotation:l.getAnnotation()}}}),"locate")}}catch(r){let i=Zr(r);return{type:"DETECTION_FAILED",adFormat:e,error:i}}},"detect"),detectDetached:o((...t)=>{try{return n.detectDetached(...t)?{type:"DETECTED",adFormat:e}:{type:"NOT_DETECTED",adFormat:e}}catch(r){let i=Zr(r);return{type:"DETECTION_FAILED",adFormat:e,error:i}}},"detectDetached")};return e},"s"),pr=o(n=>{var t;let e=(t=n.ownerDocument.defaultView)==null?void 0:t.top;if(e==null)throw new Error("Window does not have a top property");return e},"D"),en=o(n=>{if(n!=null&&n.aborted)throw new DOMException("Aborted","AbortError")},"_"),wo=1e3,gr=o((r,i)=>R(void 0,[r,i],function*(n,{signal:e,retryInterval:t=wo}){let l=null;do en(e),l=n(),l===null&&(yield Do(t));while(l===null);return l}),"f"),Do=o(n=>R(void 0,null,function*(){return yield new Promise(e=>setTimeout(e,n))}),"z"),Io=o((n,e)=>t=>R(void 0,null,function*(){return yield gr(()=>Po(n,e),{signal:t})}),"P"),Po=o((n,e)=>{let t=pr(n).document.documentElement.querySelectorAll(e);if(t.length===1)return t[0];if(t.length>1)throw new Pe(8);return null},"q"),fr=o((n,e)=>{let t=e.matchAll(n);if(t.next().value===void 0)return!1;if(t.next().value!==void 0)throw new Fe(2);return!0},"T"),Oo=o((n,e,t)=>R(void 0,null,function*(){return yield new Promise((r,i)=>{var V;let l=(V=t==null?void 0:t.validate)!=null?V:U=>typeof U=="string",u=!1,m=o(U=>{v.disconnect(),(t==null?void 0:t.signal)!=null&&t.signal.removeEventListener("abort",b),r(U)},"E"),v=new MutationObserver(()=>{if(u)return;let U=n.getAttribute(e);l(U)&&m(U)});function b(){u=!0,v.disconnect(),i(new DOMException("Aborted","AbortError"))}if(o(b,"R"),(t==null?void 0:t.signal)!=null){if(t.signal.aborted){b();return}t.signal.addEventListener("abort",b,{once:!0})}let D=n.getAttribute(e);if(l(D)){m(D);return}v.observe(n,{attributes:!0,attributeFilter:[e]})})}),"W"),xo=o(n=>{var e;return(e=n.ownerDocument)!=null?e:n},"j"),Lo=o((n,e)=>xo(e).evaluate(n,e,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),"J"),No=o(n=>(n==null?void 0:n.nodeType)===Node.ELEMENT_NODE?n:null,"Q"),Wt=o((n,e)=>{let t=[],r=Lo(n,e),i=r.iterateNext();for(;i!=null;){let l=No(i);l!=null&&t.push(l),i=r.iterateNext()}return t},"d"),tn=o((n,e)=>{let t=Wt(n,e);return t.length>0?t:!1},"x"),hr=o((n,e)=>{let t=Wt(n,e);if(t.length===0)return null;if(t.length>1)throw new Fe(2);return t[0]},"F"),vr="data-ad-format",Mo="data-ad-container",Uo=new RegExp(`<[^>]*\\s+${vr}(\\s*=\\s*(['"]).*?\\2)?(\\s|>)`,"g"),Fo=`//*[@${vr}]`,ko=Dt({name:"Annotation Spec",id:16,detectDetached:fr.bind(null,Uo),detect(n){let e=hr(Fo,n);return e!=null?qo(e,n):null}}),qo=o((n,e)=>(t,r)=>R(void 0,null,function*(){var u;let i=yield Oo(n,Mo,{signal:r}),l=(u=n.getAttribute(vr))!=null?u:"";if(t.setAnnotation({name:l,selector:i}),i.trim()==="")throw new Pe(4);return yield Io(e,i)(r)}),"ot"),$o="celtra-ad-v",jo=`.//div[contains(concat(' ', @class), ' ${$o}')]`,Bo=/<div[^>]*class\s*=\s*(['"])(?:(?:(?!\1)\S)+\s+)*\s*celtra-ad-v/g,Go=Dt({name:"Celtra",id:2,detectDetached:o(n=>{let e=n.matchAll(Bo);if(e.next().value===void 0)return!1;if(e.next().value!==void 0)throw new Fe(2);return!0},"detectDetached"),detect(n){let e=Ho(n);return e===null?null:Vo(e)}}),Vo=o(n=>(e,t)=>R(void 0,null,function*(){en(t);let r=(yield Qo(n,t)).celtra.viewabilityObservee;if(r==null)throw new Pe(4);return r}),"it"),Qo=o((n,e)=>R(void 0,null,function*(){return yield new Promise((t,r)=>{var i;((i=n.celtra)==null?void 0:i.loaded)===!0?t(n):(n.addEventListener("celtraLoaded",()=>{t(n)},{once:!0,passive:!0,signal:e}),e==null||e.addEventListener("abort",()=>{r(new Pe(16))},{once:!0,passive:!0}))})}),"ct"),Ho=o(n=>{let e=Wt(jo,n);if(e.length===0)return null;if(e.length!==1)throw new Fe(2,`Found ${e.length} Celtra tag elements`);return e[0]},"mt"),rn="ccfid",Ko=/<script[^>]*id\s*=\s*(['"])\s*ccfid(?:(?!\1).)*\1/g,Wo=`.//script[contains(@id,"${rn}")]`,zo=o(n=>{if(n==null)throw new Error("Clipcentric script node is null");if(!n.hasAttribute("id"))throw new Error("Clipcentric script node does not have an id attribute");let e=n.getAttribute("id");if(e==null)throw new Error("Clipcentric script node id attribute is null");return e.replace(rn,"")},"dt"),Yo=Dt({name:"clipcentric",id:4,detectDetached:o(n=>{let e=n.matchAll(Ko);if(e.next().value===void 0)return!1;if(e.next().value!==void 0)throw new Fe(2);return!0},"detectDetached"),detect(n){let e=Wt(Wo,n);if(e.length===0)return null;if(e.length>1)throw new Fe(2);let[t]=e,r=zo(t);return Xo(r,n)}}),Xo=o((n,e)=>(t,r)=>R(void 0,null,function*(){let i=`.//div[@data-cc-id="${n}"]`;return yield gr(()=>Jo(e,i),{signal:r})}),"Et"),Jo=o((n,e)=>{let t=pr(n).document.documentElement,r=tn(e,t);if(r!==!1&&r.length===1)return r[0];if(r!==!1&&r.length>1)throw new Pe(8);return null},"pt"),nn=o((n,e)=>(t,r)=>R(void 0,null,function*(){return yield gr(()=>Zo(n,e),{signal:r})}),"g"),Zo=o((n,e)=>{let t=pr(n).document.documentElement,r=tn(e,t);if(r!==!1&&r.length===1)return r[0];if(r!==!1&&r.length>1)throw new Pe(8);return null},"ut"),ei='.//div[@id="labBG"]',ti='.//div[@id="labBG"]',ri=/<div[^>]*id\s*=\s*(['"])\s*labBG\s*\1/g,ni=Dt({name:"Weather Channel LWIM",id:1,detectDetached:fr.bind(null,ri),detect(n){return hr(ei,n)!=null?nn(n,ti):null}}),oi='.//body[@data-product="labAdMwim"]',ii='.//div[@id="labAdDiv"]',si=/<body[^>]*data-product\s*=\s*(['"])\s*labAdMwim\s*\1/g,ai=Dt({name:"Weather Channel MWIM",id:8,detectDetached:fr.bind(null,si),detect(n){return hr(oi,n)!=null?nn(n,ii):null}}),on=[[ko],[Go,Yo,ni,ai]],li=o((n,e,t)=>{let r=e.map(u=>`${u.adFormat.id}:0`).join(","),i=t.map(u=>`${u.adFormat.id}:${u.error.errorCode}`).join(","),l=e.length>0&&t.length>0?",":"";return`${n}|${r}${l}${i}`},"k"),di=o((n,e)=>{let t=0;n.length>1&&(t|=2);for(let r of e)t|=r.error.errorCode;return t},"Y"),Kt=o(n=>{let e=n.filter(l=>l.type==="DETECTED"),t=n.filter(l=>l.type==="DETECTION_FAILED"),r=di(e,t),i=e.length===1;return r===0?{errorCode:r,detectedFormat:i?e[0]:null}:{errorCode:r,detectedFormat:null,diagnostics:li(r,e,t)}},"h"),sn=o((n,e=on)=>{for(let t of e){let r=t.map(l=>l.detectDetached(n)),i=Kt(r);if(i.detectedFormat!=null||i.errorCode!==0)return i}return Kt([])},"Lt"),ui=o(n=>{try{return n&&(n.contentDocument||n.contentWindow&&n.contentWindow.document||frames&&frames[n.name]&&frames[n.name].document)}catch(e){return null}},"_t"),ci=o((n,e)=>{try{if(ui(n)===null)return!1;if(n.src===""||n.src==="about:blank")return!0;let t=new URL(n.src),r=new URL(e.location.href);return t.origin===r.origin}catch(t){return!1}},"G"),mi=o(n=>Array.from(n.querySelectorAll("iframe")).filter(e=>ci(e,window)),"K"),an=o(n=>{let e=mi(n);if(e.length===0)return[n];let t=e.map(r=>r.contentDocument).filter(r=>r!==null).flatMap(r=>an(r.documentElement));return[n,...t]},"M"),ln=o((n,e=on)=>{let t=an(n);for(let r of e){let i=t.flatMap(u=>r.map(m=>m.detect(u))),l=Kt(i);if(l.detectedFormat!=null||l.errorCode!==0)return l}return Kt([])},"xt");s();a();var It=o(n=>{var e,t;return(t=(e=n.sameOriginIframe)!=null?e:n.crossOriginIframe)!=null?t:n.slotElement},"getDefaultElement");s();a();var dn=o(n=>n.readyState==="interactive"||n.readyState==="complete","isDocumentReady"),un=o((n,e=2e3)=>R(void 0,null,function*(){let{crossOriginIframe:t,sameOriginIframe:r,sameOriginIframeDocument:i}=n;return t!=null?"cross-origin":r==null?"no-iframe":dn(i)?"prev-ready":yield new Promise(l=>{let u=o(()=>{let v;try{v=dn(i)}catch(b){m("error");return}v&&m("state-change")},"listener"),m=o(v=>{try{i.removeEventListener("readystatechange",u)}catch(b){}l(v)},"cleanupAndResolve");try{i.addEventListener("readystatechange",u)}catch(v){l("error")}setTimeout(()=>m("timeout"),e)})}),"waitForIFrameReadyState");var pi=5e3;var Be=class{constructor(){c(this,"plugins",{});c(this,"_waitForIFrameReadyState",un)}locateAd(e,t){return R(this,null,function*(){var Tt,lt,Ye;if(e.slotElement==null)return{adRef:It(e),usedAdFormat:0,detectionDiagnostics:{errorCode:null,diagnostics:"No ad slot element"},locationDiagnostics:{errorCode:null}};let r=0,i=0,l,u=null,m=Date.now();if(t.html!==void 0){let er=Date.now();if(u=sn(t.html),r=Date.now()-er,u.errorCode!==0)return this.generateFallbackAdLocationResult(e,u);if(u.detectedFormat===null)return this.generateDefaultAdLocationResult(e,u);let h=Date.now();l=yield this._waitForIFrameReadyState(e),i=Date.now()-h}let v=Date.now(),b=ln(e.slotElement),D=Date.now()-v,V=Date.now()-m;if(b.errorCode!==0)return this.generateFallbackAdLocationResult(e,b);let{detectedFormat:U}=b;if(U===null)return u!==null&&this.core.get(F).fireEvent("detect-custom-ad-format",{cd120:l,cd130:this.getDetectedFormatId((Tt=u.detectedFormat)==null?void 0:Tt.adFormat.id),cd131:this.getDetectedFormatId(0),cm120:i},{sampleInterval:1,spoofWrapperId:!0}),this.generateDefaultAdLocationResult(e,b);this._trackDetection(U,{detachedDetectionDuration:r,iframeWaitDuration:i,detectionDuration:D,detectionPhaseDuration:V},t);let Q=new AbortController,ve=this.core.get(A).window(),Jt=ve.setTimeout(()=>{Q.abort()},pi),At=yield U.locate(Q.signal);if(ve.clearTimeout(Jt),!this.isAdSuccess(At))return this.generateFallbackAdLocationResult(e,b,At);this.core.get(F).fireEvent("detect-custom-ad-format",{cd120:l,cd130:this.getDetectedFormatId((lt=u==null?void 0:u.detectedFormat)==null?void 0:lt.adFormat.id),cd131:this.getDetectedFormatId(U.adFormat.id),cm120:i},{sampleInterval:100,spoofWrapperId:!0});let{adNode:Zt,adFormat:Lt,annotation:qe}=At;return{adRef:Zt,usedAdFormat:Lt.id,detectionDiagnostics:{errorCode:b.errorCode},locationDiagnostics:{errorCode:0},adFormatName:(Ye=qe==null?void 0:qe.name)!=null?Ye:this._formatAdFormatName(Lt),adContainerSelector:qe==null?void 0:qe.selector}})}isAdSuccess(e){return e.type===mr.AD_LOCATED}getDetectedFormatId(e){return e===void 0?"0":`${e}`}generateDefaultAdLocationResult(e,t){var r;return{adRef:It(e),usedAdFormat:0,detectionDiagnostics:{errorCode:t.errorCode,diagnostics:(r=t.diagnostics)!=null?r:""},locationDiagnostics:{errorCode:null}}}generateFallbackAdLocationResult(e,t,r){var l;let i=this.generateDefaultAdLocationResult(e,t);if(r!=null){let{adFormat:u,error:m,annotation:v}=r;return Xe(q({},i),{adFormatName:(l=v==null?void 0:v.name)!=null?l:this._formatAdFormatName(u),locationDiagnostics:{errorCode:m.errorCode,diagnostics:`${m.errorCode}|${u.id}:${m.errorCode}`},adContainerSelector:v==null?void 0:v.selector})}return i}_formatAdFormatName(e){return e.name.toLowerCase().replace(/ /g,"-")}_trackDetection(e,t,r){var ve;let i=r.parent,{adServer:l,elementId:u,adUnit:m}=i,{advertiserId:v,campaignId:b,lineItemId:D,creativeId:V}=r,U=this.core.get(w).getNonEmptyAdRenderedCount(i),Q=(ve=this.core.get(me).get(i.adServer,m.network))==null?void 0:ve.adServerId;this.core.get(F).fireEvent("ad-format-detection",{cm106:e.adFormat.id,cm107:t.detachedDetectionDuration,cm108:t.iframeWaitDuration,cm109:t.detectionDuration,cm110:t.detectionPhaseDuration,cm111:U,cm112:2,cm113:Q!=null?parseInt(Q):void 0,cd111:this.core.get(x).getNormalizedPageUrl(),cd112:this.core.get(x).getVisitUuid(),cd113:i.uuid,cd114:Ht(u,30,"~"),cd115:qt(l),cd116:v,cd117:b,cd118:D,cd119:V,cd120:m.id,cd121:kt(r)},{spoofWrapperId:!0})}};o(Be,"AdLocation"),Be=d([p],Be);s();a();var Ge=class{constructor(){c(this,"committedAdCandidates",new E.Set);c(this,"plugins",{adCandidateCommitted:o(e=>[],"adCandidateCommitted")})}commitAdCandidate(e){this.committedAdCandidates.add(e),this.plugins.adCandidateCommitted(e)}getAdCandidates(){return Array.from(this.committedAdCandidates)}};o(Ge,"AdLocationHub"),Ge=d([p],Ge);var gi=5e3,K=class{constructor(){c(this,"plugins",{adCandidateChanged:o((e,t)=>[],"adCandidateChanged"),adCandidateCommitted:o((e,t)=>[],"adCandidateCommitted"),adCandidatePubliclyCommitted:o(e=>[],"adCandidatePubliclyCommitted")});c(this,"adCandidate",new E.Link)}_changeAdCandidate(e,t,r){let i=this.adCandidate.get(e),l=i.peek();return(l==null?void 0:l.element)!==t&&(l==null||l.destroy(),l=E.Create({parent:e,element:t}),i.add(l),this.plugins.adCandidateChanged(l,r)),l}_schedulePublicCommit(e){let t=this.core.get(A).time(),r=gi-(t-e.parent.timestamp);r<=0?this.plugins.adCandidatePubliclyCommitted(e):this.core.get(X).setTimeout(e,()=>this.plugins.adCandidatePubliclyCommitted(e),r)}_onAdRendered(e,t){this._onAdRenderedAsync(e,t)}_onAdRenderedAsync(e,t){return R(this,null,function*(){var r;try{if((t==null?void 0:t.type)!=="display")return;let i=this.core.get(je).getAdContainer(e,t);if(i.slotElement==null)return;let l=It(i);this._changeAdCandidate(t,l,{usedAdFormat:0,adContainer:i});let u=yield this.core.get(Be).locateAd(i,t);if(t.destroyed)return;let m={usedAdFormat:u.usedAdFormat,adFormatName:u.adFormatName,adContainer:i,adDetectionDiagnostics:u.detectionDiagnostics.diagnostics,adLocatingDiagnostics:u.locationDiagnostics.diagnostics,adContainerSelector:u.adContainerSelector},v=this._changeAdCandidate(t,(r=u.adRef)!=null?r:l,m);this.core.get(Ge).commitAdCandidate(v),this.plugins.adCandidateCommitted(v,m),this._schedulePublicCommit(v)}catch(i){}})}};o(K,"AutoAdLocation"),d([S(w,"adRendered")],K.prototype,"_onAdRendered",1),d([de],K.prototype,"_onAdRenderedAsync",1),K=d([p],K);s();a();var cn=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1];var W=class{constructor(){c(this,"plugins",{adVisibilityChanged:o((e,t)=>[],"adVisibilityChanged")});c(this,"lastEntry",new E.Map)}_onAdCandidateCommitted(e){let t=this.core.get(A).window();t.IntersectionObserver!=null&&this.core.get(oe).observe(e,t.IntersectionObserver,e.element,r=>this._onIntersectionObserverEvent(e,r),{threshold:cn})}get(e){return this.lastEntry.get(e)}getMonitoredCandidates(){return[...this.lastEntry.keys()]}_onIntersectionObserverEvent(e,t){for(let r of t)this.lastEntry.set(e,r),this.plugins.adVisibilityChanged(e,r)}};o(W,"AdVisibility"),d([S(K,"adCandidateCommitted")],W.prototype,"_onAdCandidateCommitted",1),d([de],W.prototype,"_onIntersectionObserverEvent",1),W=d([p],W);s();a();s();a();var Ce=class{constructor(){c(this,"listeners",new E.Map)}_getListeners(){return this.listeners.conjure(this.core.session,()=>({slotVisibilityChanged:new Set,impressionViewable:new Set}))}_addEventListener(e,t){let r=this._getListeners()[e];r!=null&&r.add(t)}_removeEventListener(e,t){let r=this._getListeners()[e];r!=null&&r.delete(t)}fireEvent(e,t){let r=this._getListeners()[e];for(let i of r)try{i(t)}catch(l){}}};o(Ce,"OutboundEvents"),d([S(G,"addEventListener")],Ce.prototype,"_addEventListener",1),d([S(G,"removeEventListener")],Ce.prototype,"_removeEventListener",1),Ce=d([p],Ce);var we=class{constructor(){c(this,"committed",new E.Set);c(this,"buffer",new E.Map)}_onAdCandidatePubliclyCommitted(e){var r;this.committed.add(e);let t=(r=this.buffer.get(e))!=null?r:[];for(let{type:i,payload:l}of t)this.core.get(Ce).fireEvent(i,l);this.buffer.delete(e)}fireEvent(e,t,r){this.committed.has(e)?this.core.get(Ce).fireEvent(t,r):this.buffer.summon(e,[]).push({type:t,payload:r})}};o(we,"BufferedEvents"),d([S(K,"adCandidatePubliclyCommitted")],we.prototype,"_onAdCandidatePubliclyCommitted",1),we=d([p],we);var fi=1e3,hi=.5,vi=.3,Si=242e3,J=class{constructor(){c(this,"plugins",{impressionViewable:o(e=>[],"impressionViewable")});c(this,"viewableTimer",new E.Link);c(this,"viewable",new E.Set)}_onAdVisibilityChanged(e,t){this._startOrStopTimer(e,t)}_onPageHide(){for(let e of this.viewableTimer.keys())this._clearTimer(e)}_onPageVisible(){this.core.get(W).getMonitoredCandidates().forEach(e=>{let t=this.core.get(W).get(e);t!=null&&this._startOrStopTimer(e,t)})}_startOrStopTimer(e,t){if(this.viewable.has(e)||this.core.get($).isHidden())return;let r=this._isLargeAd(t.boundingClientRect)?vi:hi;t.intersectionRatio>=r?this._startTimer(e):this._clearTimer(e)}_startTimer(e){this.viewableTimer.get(e).conjure(()=>this.core.get(X).setTimeout(e,()=>this._onTimeout(e),fi))}_onTimeout(e){let t=e.parent.parent;this.viewable.add(e),this.plugins.impressionViewable(e),this.core.get(we).fireEvent(e,"impressionViewable",{slot:{elementId:t.elementId,source:t.adServer},timestamp:Date.now()})}_clearTimer(e){var t;(t=this.viewableTimer.get(e).peek())==null||t.destroy()}isMobile(){var i;let{navigator:e}=this.core.get(A).window(),t=(i=e.userAgentData)==null?void 0:i.mobile;if(typeof t=="boolean")return t;let{userAgent:r}=e;return r.includes("Mobi")||r.includes("Tablet")}_isLargeAd(e){return this.isMobile()?!1:e.width*e.height>=Si}};o(J,"ImpressionViewable"),d([S(W,"adVisibilityChanged")],J.prototype,"_onAdVisibilityChanged",1),d([S($,"pageHide")],J.prototype,"_onPageHide",1),d([S($,"pageVisible")],J.prototype,"_onPageVisible",1),J=d([p],J);s();a();var fn=Fn(gn());var se=class{constructor(){c(this,"fireEvent",new E.Map);c(this,"plugins",{slotVisibilityChanged:o((e,t)=>[],"slotVisibilityChanged")})}_onAdVisibilityChanged(e,t){let r=e.parent.parent;this.fireEvent.conjure(e,()=>(0,fn.default)(l=>{this.plugins.slotVisibilityChanged(e,l),this.core.get(we).fireEvent(e,"slotVisibilityChanged",{slot:{elementId:r.elementId,source:r.adServer},visibility:{percentage:l*100},timestamp:Date.now()})},200))(t.intersectionRatio)}_onPageHide(){this.fireEvent.forEach(e=>e(0))}_onPageVisible(){this.fireEvent.forEach((e,t)=>{var i;let r=(i=this.core.get(W).get(t))==null?void 0:i.intersectionRatio;r!=null&&e(r)})}};o(se,"SlotVisibilityChanged"),d([S(W,"adVisibilityChanged")],se.prototype,"_onAdVisibilityChanged",1),d([S($,"pageHide")],se.prototype,"_onPageHide",1),d([S($,"pageVisible")],se.prototype,"_onPageVisible",1),se=d([p],se);s();a();var yi=1e-4,Ai=10,Ti=9.5*60*1e3,bi=10*60*1e3,Ri=5e3;var ae=class{constructor(){c(this,"enabled",!1);c(this,"lastTimestamp",new E.Map);c(this,"lastBucketIndex",new E.Map);c(this,"buckets",new E.Map);c(this,"viewableTimestamp",new E.Map);c(this,"trackerCount",new E.Map);c(this,"lastTrackerSendTime",new E.Map);c(this,"visitId",new E.Map)}_initialize(){let{Math:e}=this.core.get(A).window();this.enabled=e.random()<yi}_onImpressionViewable(e){if(!this.enabled)return;let{Date:t}=this.core.get(A).window();this.viewableTimestamp.set(e,t.now())}_onVisibilityChanged(e,t){this.enabled&&this._updateBuckets(e,t)}_onAdCandidateCommitted(e){this.enabled&&(this.visitId.set(e,this.core.get(x).getVisitUuid()),this.core.get(X).setTimeout(e,()=>this._sendTracker(e),Ti,!0))}_onPageHide(){if(this.enabled)for(let e of this.visitId.keys())this._sendTracker(e)}_sendTracker(e){var b;let t=this.core.get(A).time(),r=e.parent.parent,i=this.lastTrackerSendTime.get(e),l=(b=this.trackerCount.get(e))!=null?b:0;if(l>=Ai||t-e.parent.timestamp>bi||i!=null&&t-i<Ri)return;let u=this.viewableTimestamp.get(e),m={cd110:this.visitId.get(e),cd111:r.uuid,cm106:this.core.get(w).getNonEmptyAdRenderedCount(r),cm107:l,cm108:u!=null?u/1e3:void 0,cm109:this.core.get(J).isMobile()?1:0},v=this._updateBuckets(e);for(let D=0;D<v.length;D++)m[`cm${110+D}`]=v[D];this.core.get(F).fireEvent("visibility-api",m,{spoofWrapperId:!0}),this.trackerCount.set(e,l+1),this.lastTrackerSendTime.set(e,t)}_getBucketIndex(e){return e===0?0:Math.floor(Math.min(e,1)*10)+1}_updateBuckets(e,t){let r=this.core.get(A).time(),i=this.buckets.conjure(e,()=>[0,0,0,0,0,0,0,0,0,0,0,0]),l=this.lastTimestamp.summon(e,r),u=this.lastBucketIndex.summon(e,0);return this.lastTimestamp.set(e,r),t!=null&&this.lastBucketIndex.set(e,this._getBucketIndex(t)),i[u]+=r-l,i}};o(ae,"VisibilityValidation"),d([M],ae.prototype,"_initialize",1),d([S(J,"impressionViewable")],ae.prototype,"_onImpressionViewable",1),d([S(se,"slotVisibilityChanged")],ae.prototype,"_onVisibilityChanged",1),d([S(K,"adCandidateCommitted")],ae.prototype,"_onAdCandidateCommitted",1),d([S($,"pageHideThrottled")],ae.prototype,"_onPageHide",1),ae=d([p],ae);var Ve=class{};o(Ve,"Visibility"),Ve=d([p,N(se),N(J),N(ae)],Ve);s();a();var Qe=class{constructor(){c(this,"plugins",{shouldPerformIntentionalDuplicateMeasurement:o(e=>[],"shouldPerformIntentionalDuplicateMeasurement"),shouldEnforcePLEMetricsCompliance:o(()=>[],"shouldEnforcePLEMetricsCompliance")})}shouldPerformIntentionalDuplicateMeasurement(e){return this.plugins.shouldPerformIntentionalDuplicateMeasurement(e).some(t=>t===!0)}shouldEnforcePLEMetricsCompliance(){return this.plugins.shouldEnforcePLEMetricsCompliance().some(e=>e===!0)}};o(Qe,"MeasurementFlags"),Qe=d([p],Qe);s();a();var ke=class{constructor(){c(this,"iframeElements",new E.Map)}_applyDebugInfo(e,t){t.setAttribute("id",`gptm-${e.elementId}`),t.dataset.slotId=e.uuid,t.dataset.slotAdCount=`${this.core.get(w).getNonEmptyAdRenderedCount(e)}`}injectScriptElement(e,t){let r=this.core.get(A).document(),i=r.createElement("iframe");this.iframeElements.set(e,i),this._applyDebugInfo(e,i),i.style.display="none",i.addEventListener("load",()=>{var l;(l=i.contentDocument)==null||l.body.appendChild(t)}),r.body.appendChild(i)}removeScriptElement(e){var t;try{(t=this.iframeElements.get(e))==null||t.remove(),this.iframeElements.delete(e)}catch(r){}}};o(ke,"MeasurementScriptInjection"),ke=d([p],ke);var le=class{constructor(){c(this,"plugins",{getEnabledAdServers:o(()=>[],"getEnabledAdServers")})}_isEligibleForMeasurement(e){return this.plugins.getEnabledAdServers().includes(e.adServer)&&(e.adServer==="custom"||e.adServerConfig!=null)}_isReadyForMeasurement(e){return this._isEligibleForMeasurement(e)&&(e.adServer==="custom"||this.core.get(z).isTargetingReliable(e))}_disableCreativeWrapperMeasurement(e){return this._isEligibleForMeasurement(e)&&!this.core.get(Qe).shouldPerformIntentionalDuplicateMeasurement(e)}_onSlotDiscovered(e){this._isEligibleForMeasurement(e)&&(this.core.get(k).setIdentifiers(e),this.core.get(k).setConstants(e),this.core.get(k).setAdUnit(e))}_onAdRequested(e){this._isEligibleForMeasurement(e)&&(this.core.get(k).setCustomDimensions(e),this.core.get(k).setQualityTargeting(e))}_onAdCandidateCommitted({parent:e,element:t},r){let i=e.parent;if((e==null?void 0:e.type)!=="display"||!this._isReadyForMeasurement(i))return;this.core.get(k).setAdInstance(i,e),this.core.get(k).setEngagement(i),this.core.get(k).setAdLocation(i,r.adContainer),this.core.get(k).setDebug(i),this.core.get(k).setGdpr(i),this.core.get(k).setDetectedAdFormat(i,r);let l=this.core.get(k).createScriptElement(i,t);this.core.get(_e).increment(),this.core.get(ke).injectScriptElement(i,l)}_onAdRemoved(e){this.core.get(_e).decrement(),this.core.get(ke).removeScriptElement(e)}};o(le,"Measurement"),d([S(z,"disableCreativeWrapperMeasurement")],le.prototype,"_disableCreativeWrapperMeasurement",1),d([S(C,"slotDiscovered")],le.prototype,"_onSlotDiscovered",1),d([S(w,"adRequestedOrInferred")],le.prototype,"_onAdRequested",1),d([S(K,"adCandidateCommitted")],le.prototype,"_onAdCandidateCommitted",1),d([S(w,"adRemoved")],le.prototype,"_onAdRemoved",1),le=d([p,N(ie),N(Ve),N(Ue)],le);var et=class{_getEnabledAdServers(){return"gpt"}};o(et,"GptMeasurement"),d([S(le,"getEnabledAdServers")],et.prototype,"_getEnabledAdServers",1),et=d([N(Y),p],et);s();a();s();a();var Pt=["BSC","ABS","CCT","CBS"],Sr=["IDS"],Ot=["VLP","TVP"],_i=[...Pt,...Sr,...Ot],Oh=[...Pt,...Sr,...Ot].filter(n=>n!=="CCT"),hn=o(n=>_i.includes(n.toUpperCase()),"isSignal"),vn=o(n=>Ot.includes(n.toUpperCase()),"isSlotSignal"),Sn=o(n=>Sr.includes(n.toUpperCase()),"isUserSignal"),En=o(n=>Pt.includes(n.toUpperCase()),"isPageSignal");s();a();s();a();var Er="qt_loaded";s();a();s();a();var pe=class{constructor(){c(this,"cache",new E.Map)}_performFetchJson(e,t){return R(this,null,function*(){let r=this.core.get(A).window().fetch,i=e;if(t!=null&&t.authToken){let l=this.core.get(ne).getAuthToken(),u=new URL(e);u.searchParams.set("token",l),i=u.href}try{return yield r(i).then(l=>l.json())}catch(l){return null}})}fetchJson(e,t){return R(this,null,function*(){let r=this.cache.summon(this.core.session,{}),i=r[e];return i==null&&(i=this._performFetchJson(e,t),r[e]=i),yield i})}};o(pe,"Fetch"),pe=d([p],pe);s();a();s();a();var zt=o(n=>n==null?"":`@${n}`,"getPositionSuffix");s();a();var Ci=/^(\d+)x(\d+)$/,yn=o(n=>n==="all"?[]:n.split(",").map(e=>{let t=e.match(Ci);return t==null?{label:e}:{width:parseInt(t[1],10),height:parseInt(t[2],10)}}),"stringToSlotSizes"),yr=o(n=>n.length===0?"all":n.map(({width:e,height:t,label:r})=>r!=null?r:`${e}x${t}`).join(","),"slotSizesToString"),An=o(n=>n==null?"":n.length>0&&n.every(({label:r})=>r==null)?yr(n):"","slotSizesToStringIfSpecific");var wi="https://pub.doubleverify.com/dvtag/signals/",ge=class{_getBaseUrl(e){let t=this.core.get(x),{ctx:r,cmp:i}=t.getTagInfo(),l=t.getNormalizedPageUrl();try{l=new URL(l).origin}catch(m){}let u=new URL(e,wi);return u.searchParams.set("ctx",r),u.searchParams.set("cmp",i),u.searchParams.set("url",l),u}getUserTargetingUrl(e){let t=this._getBaseUrl("ids/pub.json");return e.includes("IDS")&&t.searchParams.set("ids","1"),t.href}getPageTargetingUrl(e,t){let r=this._getBaseUrl("bsc/pub.json");return r.searchParams.set("url",t),e.includes("BSC")&&r.searchParams.set("bsc","1"),e.includes("ABS")&&r.searchParams.set("abs","1"),e.includes("CBS")&&r.searchParams.set("cbs","1"),e.includes("CCT")&&r.searchParams.set("cct","1"),r.href}getSlotTargetingUrl(e,t){var l;let r=this._getBaseUrl("vlp/pub.json");e.includes("VLP")&&r.searchParams.set("vlp","1"),e.includes("TVP")&&r.searchParams.set("tvp","1");let i=0;for(let u of t){let{id:m,position:v,sizes:b}=(l=u.adUnit)!=null?l:{},D=m+zt(v);r.searchParams.set(`slot-${i++}-${D}`,An(b))}return r.href}};o(ge,"SignalsUrlBuilder"),ge=d([p],ge);var He=class{constructor(){c(this,"cache",{})}_fetchFreshSignals(e,t){return R(this,null,function*(){if(!t.some(En))return{};let r=this.core.get(ge).getPageTargetingUrl(t,e),i=yield this.core.get(pe).fetchJson(r,{authToken:!0});return i instanceof Object?i:{}})}fetchSignals(e,t=3){return R(this,null,function*(){let r=this.core.get(x),i=r.getNormalizedPageUrl(),l=r.getStrippedPageUrl();this.cache[l]==null&&(this.cache[l]=this._fetchFreshSignals(i,e));let u=yield this.cache[l];return this.core.get(x).getStrippedPageUrl()!==l&&t>0?this.fetchSignals(e,t-1):u})}};o(He,"PageSignals"),He=d([p],He);s();a();var Ke=class{constructor(){c(this,"cache",{});c(this,"pendingSlots",[]);c(this,"pendingBulkRequest",null)}_scheduleBulkRequest(e){return R(this,null,function*(){yield Promise.resolve();let t=this.core.get(ge).getSlotTargetingUrl(e,this.pendingSlots);this.pendingSlots=[],this.pendingBulkRequest=null;let r=yield this.core.get(pe).fetchJson(t,{authToken:!0});return r instanceof Array?r:[]})}_fetchFreshSignals(e,t){return R(this,null,function*(){if(!t.some(vn))return{};let r=this.pendingSlots.push(e)-1;this.pendingBulkRequest==null&&(this.pendingBulkRequest=this._scheduleBulkRequest(t));let l=(yield this.pendingBulkRequest)[r];return l instanceof Object?l:{}})}_getCacheKey(e){var m,v;let{id:t,position:r,sizes:i}=(m=e.adUnit)!=null?m:{},l=t+zt(r),u=(v=i==null?void 0:i.map(b=>{var D;return(D=b.label)!=null?D:`${b.width}x${b.height}`}).sort().join(","))!=null?v:"";return`${l}#${u}`}fetchSignals(e,t){return R(this,null,function*(){let r=this._getCacheKey(e);return this.cache[r]==null&&(this.cache[r]=this._fetchFreshSignals(e,t)),this.cache[r]})}};o(Ke,"SlotSignals"),Ke=d([p],Ke);s();a();var We=class{constructor(){c(this,"cache")}_fetchFreshSignals(e){return R(this,null,function*(){if(!e.some(Sn))return{};let t=this.core.get(ge).getUserTargetingUrl(e),r=yield this.core.get(pe).fetchJson(t,{authToken:!0});return r instanceof Object?r:{}})}fetchSignals(e){return R(this,null,function*(){return this.cache==null&&(this.cache=this._fetchFreshSignals(e)),this.cache})}};o(We,"UserSignals"),We=d([p],We);s();a();var Ar=o(n=>[...new Set(n.filter(hn).map(e=>e.toLowerCase()))],"getGreenlightSignal");var O=class{constructor(){c(this,"plugins",{getEnabledSignals:o(()=>[],"getEnabledSignals"),getEnabledAdServers:o(()=>[],"getEnabledAdServers"),userTargetingUpdated:o(e=>[],"userTargetingUpdated"),pageTargetingUpdated:o(e=>[],"pageTargetingUpdated"),slotTargetingUpdated:o((e,t)=>[],"slotTargetingUpdated")})}getEnabledSignals(){return this.plugins.getEnabledSignals()}getEnabledAdServers(){return this.plugins.getEnabledAdServers()}_initialize(){this.getUserTargeting(),this.getPageTargeting()}_onAdRequestQueued(){this.getPageTargeting()}_onSlotDiscovered(e){this.getEnabledAdServers().includes(e.adServer)&&this.getSlotTargeting(e)}getUserTargeting(){return R(this,null,function*(){let e=this._fetchUserTargeting();return this.core.get(L).delayAdRequests(e),e})}getPageTargeting(){return R(this,null,function*(){let e=this._fetchPageTargeting();return this.core.get(L).delayAdRequests(e),e})}getSlotTargeting(e){return R(this,null,function*(){let t=this._fetchSlotTargeting(e);return this.core.get(L).delayAdRequests(t),t})}_fetchUserTargeting(){return R(this,null,function*(){let e=yield this.core.get(We).fetchSignals(this.getEnabledSignals());return this.core.get(I).setGlobalTargeting(this.getEnabledAdServers(),e),this._updateGlobalGreenlightSignal(e),this.plugins.userTargetingUpdated(e),e})}_fetchPageTargeting(){return R(this,null,function*(){let e=yield this.core.get(He).fetchSignals(this.getEnabledSignals());return this.core.get(I).setGlobalTargeting(this.getEnabledAdServers(),e),this._updateGlobalGreenlightSignal(e),this.plugins.pageTargetingUpdated(e),e})}_fetchSlotTargeting(e){return R(this,null,function*(){if(e.adServer==="ast")return{};let t=yield this.core.get(Ke).fetchSignals(e,this.getEnabledSignals());return this.core.get(I).setSlotTargeting(e,t),this._updateSlotGreenlightSignal(e,t),this.plugins.slotTargetingUpdated(e,t),t})}_updateGlobalGreenlightSignal(e){this.core.get(I).setGlobalTargeting(this.getEnabledAdServers(),{[Er]:Ar(Object.keys(e))},!0)}_updateSlotGreenlightSignal(e,t){this.core.get(I).setSlotTargeting(e,{[Er]:Ar(Object.keys(t))},!0)}};o(O,"Signals"),d([M],O.prototype,"_initialize",1),d([S(L,"adRequestQueued")],O.prototype,"_onAdRequestQueued",1),d([S(C,"slotDiscovered")],O.prototype,"_onSlotDiscovered",1),O=d([p],O);var tt=class{_getEnabledSignals(){return"IDS"}};o(tt,"SignalsIds"),d([S(O,"getEnabledSignals")],tt.prototype,"_getEnabledSignals",1),tt=d([p],tt);s();a();var rt=class{_getEnabledSignals(){return"BSC"}};o(rt,"SignalsBsc"),d([S(O,"getEnabledSignals")],rt.prototype,"_getEnabledSignals",1),rt=d([p],rt);s();a();var nt=class{_getEnabledSignals(){return"ABS"}};o(nt,"SignalsAbs"),d([S(O,"getEnabledSignals")],nt.prototype,"_getEnabledSignals",1),nt=d([p],nt);s();a();var ot=class{_getEnabledSignals(){return"VLP"}};o(ot,"SignalsVlp"),d([S(O,"getEnabledSignals")],ot.prototype,"_getEnabledSignals",1),ot=d([p],ot);s();a();var it=class{_getEnabledSignals(){return"TVP"}};o(it,"SignalsTvp"),d([S(O,"getEnabledSignals")],it.prototype,"_getEnabledSignals",1),it=d([p],it);s();a();s();a();var fe=class{constructor(){c(this,"pq",null)}getPq(){return this.pq==null&&(this.pq=this._initialize()),this.pq}getPts(){let e=this.getPq();return e.PTS==null&&(e.PTS={}),e.PTS}setApi(e){let t=this.getPq();t!=null&&(t.init=()=>{},t.loadSignals=e.loadSignals,t.loadSignalsForSlots=e.loadSignalsForSlots,t.getTargeting=e.getTargeting)}_pushToDvtagCmd(...e){var r,i;let t=this.core.get(A).window();t.dvtag=(r=t.dvtag)!=null?r:{},t.dvtag.cmd=(i=t.dvtag.cmd)!=null?i:[],t.dvtag.cmd.push(...e)}_initialize(){var i,l;let e=this.core.get(A).window();e.PQ=(i=e.PQ)!=null?i:{};let t=e.PQ;if(t.loaded)return{cmd:[],PTS:{}};t.loaded=!0,t.PTS=(l=t.PTS)!=null?l:{};let r=t.cmd;return t.cmd={push:o(u=>this._pushToDvtagCmd(u),"push")},Array.isArray(r)&&this._pushToDvtagCmd(...r),t}};o(fe,"LegacyPq"),fe=d([p],fe);s();a();var Tn=o(n=>{var r,i,l;let e=De(),t={id:(i=(r=n.adUnitPath)!=null?r:n.invCode)!=null?i:n.tagId,sizes:ft(yn((l=n.sizes)!=null?l:"all")),position:n.position};return{elementId:e,adUnit:t}},"parseLegacyAdUnit");s();a();var bn=o((n,e)=>{var i;let t=(i=n.IDS)==null?void 0:i[0];if(t==null)return;let r=parseInt(t);isNaN(r)||(e.IDS=r)},"setUserTargetingOnPts"),Rn=o((n,e)=>{for(let t of Pt)n[t]!=null&&(e[t]=n[t])},"setPageTargetingOnPts"),_n=o((n,e,t)=>{var m,v,b,D,V,U;let{adUnit:r}=n;if((r==null?void 0:r.id)==null)return;let i=r.id,l=yr((m=r.sizes)!=null?m:[]),u=r.position;for(let Q of Ot){let ve=e[Q];ve!=null&&((v=t[Q])!=null||(t[Q]={}),(D=(b=t[Q])[i])!=null||(b[i]={}),t[Q][i][l]=ve[0],u!=null&&((U=(V=t[Q][i])[u])!=null||(V[u]={}),t[Q][i][u][l]=ve[0]))}},"setSlotTargetingOnPts");var Oe=class{_initialize(){this.core.get(fe).setApi({loadSignals:this.loadSignals.bind(this),loadSignalsForSlots:this.loadSignalsForSlots.bind(this),getTargeting:this.getTargeting.bind(this)})}_setUserTargetingOnPts(e){let t=this.core.get(fe).getPts();bn(e,t)}_setPageTargetingOnPts(e){let t=this.core.get(fe).getPts();Rn(e,t)}_setSlotTargetingOnPts(e,t){let r=this.core.get(fe).getPts();_n(e,t,r)}loadSignals(e,t){return R(this,null,function*(){yield this._onDvtagReady("loadSignals",t)})}loadSignalsForSlots(e,t,r){return R(this,null,function*(){let i=this.core.get(O),l=this.core.get(C);for(let m of e){let v=m.getSlotElementId(),b=l.getSlot("gpt",v);if(b==null){let D=gt(m.getAdUnitPath()),V=this.core.get(me).get("gpt",D),U=V==null?void 0:V.adPositionKey;b=l.createSlot("gpt",0,v,Bt(m,U),V)}i.getSlotTargeting(b)}let u=typeof t=="function"?t:r;yield this._onDvtagReady("loadSignalsForSlots",u)})}getTargeting(e,t){return R(this,null,function*(){var u;let r=this.core.get(O),i=this.core.get(C);for(let m of(u=e.adUnits)!=null?u:[]){let{elementId:v,adUnit:b}=Tn(m),D=i.createSlot("legacy-api",0,v,b);r.getSlotTargeting(D)}let l=o(()=>t==null?void 0:t(void 0,this.core.get(fe).getPts()),"callback");yield this._onDvtagReady("getTargeting",l)})}_getPubAdsTargeting(e){var t,r,i;return(i=(r=(t=this.core.get(A).window().googletag)==null?void 0:t.pubads)==null?void 0:r.call(t).getTargeting(e))!=null?i:[]}_onDvtagReady(e,t){return R(this,null,function*(){yield new Promise(r=>{this.core.get(A).window().dvtag.queueAdRequest({callback:o(()=>{try{t==null||t()}catch(i){}r()},"callback"),timestamp:new Date().getTime(),timeout:750,internal:!0})})})}};o(Oe,"LegacyLayer"),d([M],Oe.prototype,"_initialize",1),d([S(O,"userTargetingUpdated")],Oe.prototype,"_setUserTargetingOnPts",1),d([S(O,"pageTargetingUpdated")],Oe.prototype,"_setPageTargetingOnPts",1),d([S(O,"slotTargetingUpdated")],Oe.prototype,"_setSlotTargetingOnPts",1),Oe=d([p],Oe);s();a();s();a();var he=class{_defineSlot(e,t={}){if(typeof e!="string"||t==null||typeof t!="object")return;let r={id:te(t.id),network:te(t.network),sizes:t.sizes!=null?ft(t.sizes):void 0,position:te(t.position)};this.core.get(C).createSlot("custom",0,e,r)}_adRendered(e,t){if(typeof e!="string"||t==null||typeof t!="object")return;let r=this.core.get(C).getSlot("custom",e);if(r==null)return;let i={type:"display",advertiserId:te(t.advertiserId),campaignId:te(t.campaignId),creativeId:te(t.creativeId),lineItemId:te(t.lineItemId),renderedSize:jt(t.renderedSize)};this.core.get(w).setAdRendered(r,i)}_getTargeting(e){let t=this.core.get(I);if(typeof e!="string")return t.getGlobalTargeting("custom");let r=this.core.get(C).getSlot("custom",e);return r==null?t.getGlobalTargeting("custom"):t.getTargeting(r)}};o(he,"CustomAdServer"),d([S(G,"defineSlot")],he.prototype,"_defineSlot",1),d([S(G,"getTargeting")],he.prototype,"_getTargeting",1),he=d([p],he);var st=class{_getEnabledAdServers(){return"custom"}};o(st,"CustomSignals"),d([S(O,"getEnabledAdServers")],st.prototype,"_getEnabledAdServers",1),st=d([p,N(he)],st);s();a();var at=class{_getEnabledAdServers(){return"gpt"}};o(at,"GptSignals"),d([S(O,"getEnabledAdServers")],at.prototype,"_getEnabledAdServers",1),at=d([p,N(Y)],at);s();a();s();a();s();a();var Tr=class Tr{constructor(){c(this,"total",0);c(this,"dataPoints",0)}push(e){return this.total+=e,this.dataPoints+=1,this}get(){return this.total/this.dataPoints}getRounded(){return Math.round(this.get())}};o(Tr,"Average");var xt=Tr;s();a();var ze=o(()=>{var n,e,t;return Math.floor((t=(e=(n=window.performance)==null?void 0:n.now)==null?void 0:e.call(n))!=null?t:Date.now())},"perfNowOrDateNow");s();a();s();a();var br=class br{constructor(){c(this,"_firstQueuedAdRequest",1/0);c(this,"_lastQueuedAdRequest",-1/0);c(this,"_firstReleasedAdRequest",1/0);c(this,"_lastReleasedAdRequest",-1/0);c(this,"_lastReleasedAdRequestTime",null);c(this,"_hasBeenSuccessful",!1)}setAdRequestQueued(e){this._firstQueuedAdRequest=Math.min(this._firstQueuedAdRequest,e),this._lastQueuedAdRequest=Math.max(this._lastQueuedAdRequest,e)}setAdRequestReleased(e){this._firstReleasedAdRequest=Math.min(this._firstReleasedAdRequest,e),this._lastReleasedAdRequest=Math.max(this._lastReleasedAdRequest,e),this._lastReleasedAdRequestTime=ze()}getLastQueuedAdRequest(){return Number.isFinite(this._lastQueuedAdRequest)?this._lastQueuedAdRequest:null}getLastReleasedAdRequest(){return Number.isFinite(this._lastReleasedAdRequest)?this._lastReleasedAdRequest:null}getLastReleasedAdRequestTime(){return this._lastReleasedAdRequestTime}getLastSuccessfulAdRequest(){let e=Math.max(this._firstQueuedAdRequest,this._firstReleasedAdRequest),t=Math.min(this._lastQueuedAdRequest,this._lastReleasedAdRequest);return t<e?null:t}getPreviouslySuccessful(){return this._hasBeenSuccessful}markAdServerAdRequest(){this.getLastSuccessfulAdRequest()!=null&&(this._hasBeenSuccessful=!0),this._firstQueuedAdRequest=1/0,this._lastQueuedAdRequest=-1/0,this._firstReleasedAdRequest=1/0,this._lastReleasedAdRequest=-1/0,this._lastReleasedAdRequestTime=null}};o(br,"SlotAdRequestTracker");var Yt=br;s();a();var Xt=(u=>(u.UNKNOWN="UNKNOWN",u.SEEN="SEEN",u.NOT_READY="NOT_READY",u.POSSIBLE_TIMEOUT="POSSIBLE_TIMEOUT",u.PREV_READY="PREV_READY",u.READY="READY",u))(Xt||{});var Rr="dv_upt_slot_ready",Di=["https://securepubads.g.doubleclick.net/gampad/ads?","https://pagead2.googlesyndication.com/gampad/ads?"],Ii=750,Z=class{constructor(){c(this,"plugins",{onSlotRequested:o(()=>[],"onSlotRequested"),onSlotRequestValidated:o(()=>[],"onSlotRequestValidated")});c(this,"validateAdRequests",!1);c(this,"lastAdRequestQueued",null);c(this,"lastAdRequestReleased",null);c(this,"state",{adRequestTracker:new E.Map,triggered:new E.Map})}_getSlotAdRequestTracker(e){return this.state.adRequestTracker.conjure(e,()=>new Yt)}_onAdRequestQueued({index:e}){this.lastAdRequestQueued=e;for(let t of this.core.get(C).getSlots())this._getSlotAdRequestTracker(t).setAdRequestQueued(e),this.state.triggered.set(t,!1)}_onAdRequestBeforeRelease({index:e}){let t=this.core.get(I);this.lastAdRequestReleased=e;for(let r of this.core.get(C).getSlots())this._getSlotAdRequestTracker(r).setAdRequestReleased(e),this.validateAdRequests&&t.setSlotTargeting(r,{[Rr]:["1"]})}_onSlotDiscovered(e,t){t===0&&this.lastAdRequestQueued!=null&&this._getSlotAdRequestTracker(e).setAdRequestQueued(this.lastAdRequestQueued)}_determineReadyState(e){let t=this._getSlotAdRequestTracker(e),r=t.getLastQueuedAdRequest(),i=t.getLastSuccessfulAdRequest(),l=t.getPreviouslySuccessful();return i!=null?"READY":l?"PREV_READY":r!=null?"NOT_READY":Date.now()-e.creationTime>Ii?"SEEN":"UNKNOWN"}getSlotReadyStateOnAdServerAdRequest(e){let t=this._determineReadyState(e);if(t==="READY"){if(this.state.triggered.get(e)===!0)return{readyState:"PREV_READY"};this.state.triggered.set(e,!0);let r=this._getSlotAdRequestTracker(e).getLastReleasedAdRequestTime();return{readyState:t,readyFor:ze()-r}}return{readyState:t}}_onSlotRequested(e){let{readyState:t,readyFor:r}=this.getSlotReadyStateOnAdServerAdRequest(e);this._getSlotAdRequestTracker(e).markAdServerAdRequest(),this.validateAdRequests&&this.core.get(I).setSlotTargeting(e,{[Rr]:["0"]}),this.plugins.onSlotRequested(e,t,r)}enableAdRequestValidation(){if(!this.validateAdRequests)try{let e=this._processResourceRequest.bind(this);new PerformanceObserver(r=>r.getEntries().forEach(e)).observe({type:"resource"}),this.validateAdRequests=!0}catch(e){}}_processResourceRequest(e){var t,r,i;try{if(Di.every(m=>!e.name.startsWith(m)))return;let u=(r=(t=new URL(e.name).searchParams.get("prev_scp"))==null?void 0:t.split("|"))!=null?r:[];for(let m of u){let b=((i=new URLSearchParams(m).get(Rr))==null?void 0:i[0])==="1";this.plugins.onSlotRequestValidated(b)}}catch(l){}}};o(Z,"SlotReadinessTracker"),d([S(L,"adRequestQueued")],Z.prototype,"_onAdRequestQueued",1),d([S(L,"adRequestBeforeRelease"),S(L,"adRequestTimedOut")],Z.prototype,"_onAdRequestBeforeRelease",1),d([S(C,"slotDiscovered")],Z.prototype,"_onSlotDiscovered",1),d([S(w,"adRequested")],Z.prototype,"_onSlotRequested",1),Z=d([p],Z);var Pi="implcheck",Oi=1e-4,xi=5e3,Li=5,ee=class{constructor(){c(this,"enabled",!1);c(this,"totalInternalAdRequestQueuedCount",0);c(this,"totalAdRequestsCompletedCount",0);c(this,"totalSlotsRequestedCount",0);c(this,"totalSlotsRequestedOkCount",0);c(this,"totalTimeoutCount",0);c(this,"trackersSent",0);c(this,"totalValidatedAdServerRequests",{ok:0,notOk:0});c(this,"lastOnDvtagReadyCall",NaN);c(this,"slotReqAvgTimeSinceCall",new xt);c(this,"slotReqAvgTimeSinceDone",new xt);c(this,"batch",null)}isDebugForceEnabled(){return!1}_initialize(){this.enabled=this.core.get(ee).isDebugForceEnabled()||Math.random()<Oi,this.enabled&&this.core.get(Z).enableAdRequestValidation()}_onAdRequestQueued(e){this.enabled&&(this.lastOnDvtagReadyCall=ze(),e.internal&&(this.totalInternalAdRequestQueuedCount+=1))}_onAdRequestCompleted(e){this.enabled&&(this.totalAdRequestsCompletedCount+=1,(e.status==="tag-timeout"||e.status==="queue-timeout")&&(this.totalTimeoutCount+=1))}_onSlotRequested(e,t,r){if(!this.enabled)return;let i=this._getOrStartBatch();this.totalSlotsRequestedCount+=1,t==="READY"&&(this.totalSlotsRequestedOkCount+=1),i.slots[t].push(e.elementId),r!=null&&(this.slotReqAvgTimeSinceDone.push(r),this.slotReqAvgTimeSinceCall.push(ze()-this.lastOnDvtagReadyCall));let l=this._validateAdServerTargeting(e);l===1?i.targeting.extendedCount+=1:l===0&&(i.targeting.reducedCount+=1)}_validateAdServerTargeting(e){let t=this.core.get(I),r=2,i=t.getTargeting(e);for(let[l,u]of Object.entries(i)){let m=t.getAdServerTargeting(e,l);if(u.length>m.length||u.some(v=>!m.includes(v)))return 0;m.length>u.length&&(r=1)}return r}_onSlotRequestValidated(e){e?this.totalValidatedAdServerRequests.ok+=1:this.totalValidatedAdServerRequests.notOk+=1}_sendTracker(){let e=this.core.get(Te).getRestoreCount(),{slots:t,targeting:r,start:i}=this._getOrStartBatch(),l={cd110:t.READY.join(),cd111:t.PREV_READY.join(),cd112:t.SEEN.join(),cd113:t.NOT_READY.join(),cd114:t.UNKNOWN.join(),cd115:t.POSSIBLE_TIMEOUT.join(),cm106:this.trackersSent,cm107:i,cm109:this.totalTimeoutCount,cm110:this.slotReqAvgTimeSinceCall.getRounded(),cm111:this.slotReqAvgTimeSinceDone.getRounded(),cm112:this.totalSlotsRequestedOkCount,cm113:this.totalValidatedAdServerRequests.ok,cm114:this.totalValidatedAdServerRequests.notOk,cm115:e,cm116:this.totalAdRequestsCompletedCount,cm117:this.totalInternalAdRequestQueuedCount,cm118:this.totalSlotsRequestedCount,cm119:r.reducedCount,cm120:r.extendedCount};this.core.get(F).fireEvent(Pi,l),this.batch=null,this.trackersSent+=1,this.trackersSent>=Li&&(this.enabled=!1)}_getOrStartBatch(){return this.batch==null&&(this.batch={start:ze(),slots:Object.fromEntries(Object.values(Xt).map(e=>[e,[]])),targeting:{extendedCount:0,reducedCount:0}},setTimeout(()=>this._sendTracker(),xi)),this.batch}};o(ee,"ImplementationValidator"),d([M],ee.prototype,"_initialize",1),d([S(L,"adRequestQueued")],ee.prototype,"_onAdRequestQueued",1),d([S(L,"adRequestCompleted")],ee.prototype,"_onAdRequestCompleted",1),d([S(Z,"onSlotRequested")],ee.prototype,"_onSlotRequested",1),d([S(Z,"onSlotRequestValidated")],ee.prototype,"_onSlotRequestValidated",1),ee=d([p],ee);s();a();var xe=class{_initialize(){this._flushCommandBuffer()}_flushCommandBuffer(){return R(this,null,function*(){var l;yield Promise.resolve();let e=this.core.get(A).window(),t=(l=e.dvtag)!=null?l:{};e.dvtag=t,t.cmd instanceof Array||(t.cmd=[]);let r=t.cmd,i=r.length;t.cmd={push:o((...u)=>{for(let m of u)try{m()}catch(v){}return i+=u.length,i},"push")},t.cmd.push(...r)})}};o(xe,"CommandBuffer"),d([M],xe.prototype,"_initialize",1),d([de],xe.prototype,"_flushCommandBuffer",1),xe=d([p],xe);var yt=class{};o(yt,"HouseHold"),yt=d([p,N(G),N(L),N(xe),N(F),N(H),N(he),N(ee)],yt);s();a();s();a();var Cn=o(n=>{var e,t,r,i,l,u;try{let m={};for(let[v,b,D]of(t=(e=window.dvtag)==null?void 0:e._overrides)!=null?t:[])(r=m[v])!=null||(m[v]={}),(l=(i=m[v])[b])!=null||(i[b]=D);for(let v of n)for(let[b,D]of Object.entries((u=m[v.name])!=null?u:{}))v.prototype[b]=D}catch(m){}},"applyDebugOverrides");var Ni=o(()=>{var n,e;((n=window.dvtag)==null?void 0:n._core)==null&&(Cn(Ft),window.dvtag=(e=window.dvtag)!=null?e:{},window.dvtag._core=new _t(Ft),window.dvtag._core.execute())},"main");try{Ni()}catch(n){}})();
